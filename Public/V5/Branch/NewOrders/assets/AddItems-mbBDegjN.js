var H=Object.defineProperty,w=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var A=(e,t,a)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,f=(e,t)=>{for(var a in t||(t={}))K.call(t,a)&&A(e,a,t[a]);if(v)for(var a of v(t))P.call(t,a)&&A(e,a,t[a]);return e},S=(e,t)=>w(e,M(t));import{S as J}from"./EntryFile-D68kwv0T.js";let k=()=>{U()},U=()=>{const e=new URL(window.location.href),t=new URL("./Customer.html",e);let a=x(),l=W();t.searchParams.append("CustomerMobile",a),t.searchParams.append("CustomerName",l),window.location.href=t.href},x=()=>{let t=document.getElementById("CustomerMobileId");if(t!==null)return t.value.trim()},W=()=>{let t=document.getElementById("CustomerNameId");if(t!==null)return t.value.trim()},q=()=>{let e=document.getElementById("BranchNameAnchorId");e!==null&&e.addEventListener("click",k)};const G=()=>{var e=$("#table").bootstrapTable("getData");return e.length===0?(window.alert("Please Add Items"),!1):!0};let _=()=>{G()&&Y()},Y=()=>{const e=new URL(window.location.href),t=new URL("./Settlement.html",e);let a=z();t.searchParams.append("OrderNumber",a),window.location.href=t.href},z=()=>{let t=document.getElementById("OrderNumberId");if(t!==null)return t.innerHTML.trim()},Q=()=>{let e=document.getElementById("CheckOutButtonId");e!==null&&e.addEventListener("click",_)},X=()=>{q(),Q()},Z=()=>!(ee()===!1||te()===!1||ae()===!1||le()===!1||oe()===!1||re()===!1||ne()===!1);const ee=()=>{let e=document.getElementById("TableFooterItemNameId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},te=()=>{let e=document.getElementById("TableFooterPcsInputId");return e.value===""||e.value<=0?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},ae=()=>{let e=document.getElementById("exampleFormControlInput1");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},le=()=>{let e=document.getElementById("TableFooterFactoryInputId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},oe=()=>{let e=document.getElementById("TableFooterCategoryId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},re=()=>{let e=document.getElementById("TableFooterdateInputId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},ne=()=>{let e=document.getElementById("TableFooterRateInputId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},de="POST",ce={Accept:"application/json","Content-Type":"application/json"},ue="",B={method:de,headers:ce,body:ue},me="binV4",se="Transactions",Ie="Kakinada",ie={OrderKey:"PresentOrder",ItemNamesKey:"ItemNames",AddOnsKey:"AddOns",PresentOrderAddOnsKey:"PresentOrderAddOns"},Le={ItemsTable:{DeleteUrl_Common:"$tableName/SubTable/Delete/SubKey/:Id/:inKey/:SubId",DeleteAddOnUrl:"/Custom/Cleaning/Branch/Order/NewOrder/addOn/$tableName/:Id/:SubId/:AddOnKey",DeleteItemUrl:"/Custom/Cleaning/Branch/Order/NewOrder/Item/$tableName/:Id/:SubId",AlterGetUrl:"/Custom/Cleaning/Branch/Order/SubTable/ItemsInOrder/:Id/:SubId/$tableName"}},Fe={AddOnModal:"AddOnModal"},s={routePath:me,folderName:se,tableName:Ie,localStorageKeys:ie,ApiUrls:Le,ModalIds:Fe};let je=({inCategory:e,inItemType:t})=>{let a=s.localStorageKeys.ItemNamesKey,l=localStorage.getItem(a);return JSON.parse(l).filter(n=>n.Category===e&&n.ItemType===t)},b=({inCategory:e,inItemType:t,inService:a})=>{let l=s.localStorageKeys.ItemNamesKey,o=localStorage.getItem(l);return JSON.parse(o).find(c=>c.Category===e&&c.ItemType===t&&c.Service===a)},fe=()=>{let e=s.localStorageKeys.ItemNamesKey,t=localStorage.getItem(e);return JSON.parse(t)};const Se=()=>{let e=ge(),t=ye(),a=be(),l=Te(),o=ve(),r=pe(),n=Oe();const c=Ve();localStorage.setItem("DeliveryDateTime",JSON.stringify(n));let m=JSON.parse(localStorage.getItem("PresentOrderAddOns"));const d=b({inCategory:e,inItemType:t,inService:c});let u={};return u.Category=e,u.ItemName=d.ItemName,u.ItemType=t,u.Rate=a,u.Pcs=l,u.Total=o,u.location=r,u.DeliveryDateTime=n,u.ItemService=c,u.AddOnArray=m,u};let Ve=()=>{let t=document.getElementById("TableFooterItemServiceId");if(t!==null)return t.value.trim()},ge=()=>{let t=document.getElementById("TableFooterCategoryId");if(t!==null)return t.value.trim()},ye=()=>{let t=document.getElementById("TableFooterItemNameId");if(t!==null)return t.value.trim()},be=()=>{let t=document.getElementById("TableFooterRateInputId");if(t!==null)return t.value.trim()},Te=()=>{let t=document.getElementById("TableFooterPcsInputId");if(t!==null)return t.value.trim()},pe=()=>{let t=document.getElementById("TableFooterFactoryInputId");if(t!==null)return t.value.trim()},Oe=()=>{let t=document.getElementById("TableFooterdateInputId");if(t!==null)return t.value.trim()},ve=()=>{let t=document.getElementById("TableFooterRateInputId"),l=document.getElementById("TableFooterPcsInputId"),o=JSON.parse(localStorage.getItem("PresentOrderAddOns")),r=o!==null?o.map(c=>c.AddOnRate).reduce((c,m)=>c+parseInt(m),0):0,n=parseInt(t.value)+r;return console.log("Total:",n*l.value),n*l.value},Ae=()=>(B.body=JSON.stringify(Se()),B),$e=async()=>{let e=localStorage.getItem("BranchName"),t=parseInt(document.getElementById("OrderNumberId").innerHTML),a=Ae(),l=`/${s.routePath}/${e}/SubTable/Create/${t}/ItemsInOrder`;return await await fetch(l,a)},F=async()=>{let e=localStorage.getItem("BranchName"),t=s.localStorageKeys.OrderKey,a=`/Custom/Cleaning/Branch/Order/NewOrder/MaxRow/${e}`,o=await(await fetch(a)).json();localStorage.setItem(t,JSON.stringify(o))};const Be=()=>{let e=s.localStorageKeys.OrderKey,t=localStorage.getItem(e),a=JSON.parse(t);return he({inItemsObject:a.ItemsInOrder})},he=({inItemsObject:e})=>Object.entries(e).map(([a,l])=>S(f({},l),{pk:a})),j=()=>{let e=Be();var t=$("#table");t.bootstrapTable("load",e)};let Ce=()=>{Ne(),T()},Ne=()=>{let t=document.getElementById("BranchNameId"),a=localStorage.getItem("BranchName");t!==null&&(t.innerHTML=a)};const T=()=>{var e=new Date,t=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0"),l=e.getFullYear(),o=l+"-"+a+"-"+t;e.setDate(e.getDate()+7);var r=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),c=e.getFullYear(),m=c+"-"+n+"-"+r,d=document.getElementById("TableFooterdateInputId");if(d.setAttribute("min",o),d){d.setAttribute("min",o);const u=JSON.parse(localStorage.getItem("DeliveryDateTime"));u?d.value=u:d.value=m}};let Ee=()=>{F().then(()=>{j(),localStorage.removeItem("PresentOrderAddOns"),$("#table").bootstrapTable("refresh"),$("#AddItemsId")[0].reset(),$("#TableFooterItemNameId").focus(),T(),localStorage.setItem("PresentOrderAddOns",JSON.stringify([]));var e=new Event("change");document.getElementById("TableFooterCategoryId")!==null&&document.getElementById("TableFooterCategoryId").dispatchEvent(e)})},Re=async()=>{(await $e()).status===200&&Ee()};const De=()=>{Z()&&Re()};let He=()=>{let e=document.getElementById("TableFooterSaveButtonId");e!==null&&e.addEventListener("click",De)};const we=({inCategorySelected:e})=>{let a=document.getElementById("ItemsDataListId"),l=e,r=fe().filter(I=>I.Category===l);const n=Object.groupBy(r,({ItemType:I})=>I);let m=Object.keys(n).map(I=>I).sort((I,i)=>I==i?0:I>i?1:-1);for(var d="",u=0;u<m.length;u++)d+=`<option value="${m[u]}">${m[u]}</option>`;a.innerHTML=d},Me=e=>{let a=e.currentTarget.value;we({inCategorySelected:a})};let Ke=()=>{let e=document.getElementById("TableFooterCategoryId");e!==null&&e.addEventListener("change",Me)};const E="TableFooterItemServiceId",Pe=e=>{let a=e.currentTarget.value;const l=Je();let o=document.getElementById(E),r=je({inCategory:l,inItemType:a});const n=Object.groupBy(r,({Service:i})=>i);let d=Object.keys(n).map(i=>i).sort((i,g)=>i==g?0:i>g?1:-1).sort((i,g)=>i==="DW"?-1:0);for(var u="",I=0;I<d.length;I++)u+=`<option value="${d[I]}">${d[I]}</option>`;o.innerHTML=u,ke()};let Je=()=>{let t=document.getElementById("TableFooterCategoryId");if(t!==null)return t.value.trim()},ke=()=>{var e=new Event("change");let t=document.getElementById(E);t!==null&&t.dispatchEvent(e)},Ue=()=>{let e=document.getElementById("TableFooterItemNameId");e!==null&&e.addEventListener("change",Pe)};const h=(e,t,a)=>{xe(e.ItemName),We(e.Category),qe(e.DryWashRate),Ge(1),$("#ItemsOnModal").modal("hide"),document.getElementById("TableFooterSaveButtonId").click()};let xe=e=>{let a=document.getElementById("TableFooterItemNameId");a!==null&&(a.value=e)},We=e=>{let a=document.getElementById("TableFooterCategoryId");a!==null&&(a.value=e)},qe=e=>{let a=document.getElementById("TableFooterRateInputId");a!==null&&(a.value=e)},Ge=e=>{let a=document.getElementById("TableFooterPcsInputId");a!==null&&(a.value=e)};const _e=e=>{let t="ItemsOnModal";var a=$(document.getElementById(t).querySelector("table"));e?(a.bootstrapTable({data:jFLocalFromLocalStorageWithFilter(e),onClickRow:h}),document.getElementById("SearchString").innerHTML=`Search Results for - ${e}`):(a.bootstrapTable({data:jFLocalFromLocalStorage(),onClickRow:h}),document.getElementById("SearchString").innerHTML="All Items"),$(`#${t}`).modal("show")},Ye=()=>{let e=document.getElementById("TableFooterItemNameId").value;_e(e)};let ze=()=>{let e=document.getElementById("TableFooterItemNameSearchButtonId");e!==null&&e.addEventListener("click",Ye)},p=document.getElementById("AddOnModalLocalStorage"),Qe=({inRow:e})=>{const t=Xe(),a=Ze(),l=et();tt(t),at(a),lt(l)},Xe=()=>{let t=document.getElementById("TableFooterItemNameId");if(t!==null)return t.value.trim()},Ze=()=>{let t=document.getElementById("TableFooterRateInputId");if(t!==null)return t.value.trim()},et=()=>{let t=document.getElementById("CustomerNameId");if(t!==null)return t.value.trim()},tt=e=>{const t=p.querySelector(".AddOnModalLocalStorageItemNameClass");t!==null&&(t.value=e)},at=e=>{const t=p.querySelector(".AddOnModalLocalStorageItemRateClass");t!==null&&(t.value=e)},lt=e=>{const t=p.querySelector(".AddOnModalLocalStorageSerialClass");t!==null&&(t.value=e)};const ot=()=>{let e=s.localStorageKeys.PresentOrderAddOnsKey,t=localStorage.getItem(e);return JSON.parse(t)},rt="AddOnModalLocalStorageTable",O=()=>{let e=ot();var t=$(`#${rt}`);t.bootstrapTable("load",e===null?[]:e)},nt="AddOnModalLocalStorage",dt=({inRow:e})=>{O();let t=document.getElementById(nt);Qe({inRow:e}),$(t).modal("show")};let ct=()=>{let e=document.getElementById("TableFooterAddOnId");e!==null&&e.addEventListener("click",dt)};const ut=e=>{let a=e.currentTarget.value;const l=st(),o=mt();let r=b({inCategory:l,inItemType:o,inService:a});It(r.DryWashRate)};let mt=()=>{let t=document.getElementById("TableFooterItemNameId");if(t!==null)return t.value.trim()},st=()=>{let t=document.getElementById("TableFooterCategoryId");if(t!==null)return t.value.trim()},It=e=>{let a=document.getElementById("TableFooterRateInputId");a!==null&&(a.value=e)},it=()=>{let e=document.getElementById("TableFooterItemServiceId");e!==null&&e.addEventListener("change",ut)},Lt=()=>!(Ft()===!1||jt()===!1||ft()===!1||St()===!1||Vt()===!1||gt()===!1||yt()===!1);const Ft=()=>{let e=document.getElementById("TableFooterItemNameId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},jt=()=>{let e=document.getElementById("TableFooterPcsInputId");return e.value===""||e.value<=0?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},ft=()=>{let e=document.getElementById("exampleFormControlInput1");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},St=()=>{let e=document.getElementById("TableFooterFactoryInputId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},Vt=()=>{let e=document.getElementById("TableFooterCategoryId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},gt=()=>{let e=document.getElementById("TableFooterdateInputId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},yt=()=>{let e=document.getElementById("TableFooterRateInputId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},bt="PUT",Tt={Accept:"application/json","Content-Type":"application/json"},pt="",C={method:bt,headers:Tt,body:pt},Ot=()=>{let e=At(),t=$t(),a=Bt(),l=ht(),o=Et(),r=Ct(),n=Nt();const c=vt();localStorage.setItem("DeliveryDateTime",JSON.stringify(n));let m=JSON.parse(localStorage.getItem("PresentOrderAddOns"));const d=b({inCategory:e,inItemType:t,inService:c});let u={};return u.Category=e,u.ItemName=d.ItemName,u.ItemType=t,u.Rate=a,u.Pcs=l,u.Total=o,u.location=r,u.DeliveryDateTime=n,u.ItemService=c,u.AddOnArray=m,u};let vt=()=>{let t=document.getElementById("TableFooterItemServiceId");if(t!==null)return t.value.trim()},At=()=>{let t=document.getElementById("TableFooterCategoryId");if(t!==null)return t.value.trim()},$t=()=>{let t=document.getElementById("TableFooterItemNameId");if(t!==null)return t.value.trim()},Bt=()=>{let t=document.getElementById("TableFooterRateInputId");if(t!==null)return t.value.trim()},ht=()=>{let t=document.getElementById("TableFooterPcsInputId");if(t!==null)return t.value.trim()},Ct=()=>{let t=document.getElementById("TableFooterFactoryInputId");if(t!==null)return t.value.trim()},Nt=()=>{let t=document.getElementById("TableFooterdateInputId");if(t!==null)return t.value.trim()},Et=()=>{let t=document.getElementById("TableFooterRateInputId"),l=document.getElementById("TableFooterPcsInputId"),o=JSON.parse(localStorage.getItem("PresentOrderAddOns")),r=o!==null?o.map(c=>c.AddOnRate).reduce((c,m)=>c+parseInt(m),0):0,n=parseInt(t.value)+r;return console.log("Total:",n*l.value),n*l.value},Rt=()=>(C.body=JSON.stringify(Ot()),C),Dt=async()=>{let e=localStorage.getItem("BranchName"),t=parseInt(document.getElementById("OrderNumberId").innerHTML),a=parseInt(document.getElementById("SubId").innerHTML),l=Rt(),o=`/Custom/Cleaning/Branch/Order/SubTable/ItemsInOrder/${t}/${a}/${e}`;return await await fetch(o,l)},Ht=()=>{F().then(()=>{j(),localStorage.removeItem("PresentOrderAddOns"),$("#table").bootstrapTable("refresh"),$("#AddItemsId")[0].reset(),$("#TableFooterItemNameId").focus(),T(),localStorage.setItem("PresentOrderAddOns",JSON.stringify([])),Pt(),wt(),Mt(),Kt()})},wt=()=>{document.getElementById("SubId").classList.add("d-none")};const Mt=()=>{document.getElementById("TableFooterSaveButtonId").classList.remove("d-none")};let Kt=()=>{document.getElementById("TableFooterAlterButtonId").classList.add("d-none")};const Pt=()=>{var e=new Event("change");document.getElementById("TableFooterCategoryId")!==null&&document.getElementById("TableFooterCategoryId").dispatchEvent(e)};let Jt=async()=>{(await Dt()).status===200&&Ht()};const kt=()=>{Lt()&&Jt()};let Ut=()=>{let e=document.getElementById("TableFooterAlterButtonId");e!==null&&e.addEventListener("click",kt)};const xt=()=>{Ke(),ct(),ze(),it(),Ue(),He(),Ut()};let Wt=()=>{X(),xt(),qt()},qt=()=>{var e=new Event("change");document.getElementById("TableFooterCategoryId")!==null&&document.getElementById("TableFooterCategoryId").dispatchEvent(e)},Gt=async()=>{await F()},_t=({inRow:e})=>{const t=e;Yt(t.ItemName),zt(t.pk),Qt(t.Rate)},Yt=e=>{let a=document.getElementById("AddOnModalItemNameId");a!==null&&(a.value=e)},zt=e=>{let a=document.getElementById("AddOnModalItemSerialId");a!==null&&(a.value=e)},Qt=e=>{let a=document.getElementById("exampleFormControlInput1");a!==null&&(a.value=e)};const Xt=({inRow:e})=>{if(e.AddOnArray.length===0)return;let t=e.AddOnArray;const a=s.ModalIds.AddOnModal;var l=$("#AddOnTable");l.bootstrapTable("load",t),_t({inRow:e}),$(`#${a}`).modal("show")},Zt=async({inRowpk:e,inItemSerial:t})=>{const a=s.ApiUrls.ItemsTable.DeleteItemUrl;let l=localStorage.getItem("BranchName");const o=t;let r=a.replace("$tableName",l).replace(":Id",e).replace(":SubId",o);return await fetch(r,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}})},ea=({inResponse:e})=>{e.status===200&&F().then(t=>{j(),$("#TableFooterItemNameId").focus()})},ta=async({inItemSerial:e})=>{let t=aa(),a=await Zt({inRowpk:t,inItemSerial:e});ea({inResponse:a})},aa=()=>{let e=s.localStorageKeys.OrderKey,t=localStorage.getItem(e);return JSON.parse(t).pk},la=async({inRowpk:e,inItemSerial:t})=>{const a=s.ApiUrls.ItemsTable.AlterGetUrl;let l=localStorage.getItem("BranchName");const o=t;let r=a.replace("$tableName",l).replace(":Id",e).replace(":SubId",o);return await fetch(r)},oa=e=>{let a=JSON.parse(localStorage.getItem("ItemNames")).find(l=>l.ItemName==e.ItemName);ra({inValue:e.Category}),na({inValue:a.ItemType}),da({inValue:e.ItemService}),ca({inValue:e.Rate}),ua({inValue:e.Pcs}),ma({inValue:e.location}),sa({inValue:e.DeliveryDateTime}),Ia({inValue:e.SubKey}),ia(),La(),localStorage.setItem("PresentOrderAddOns",JSON.stringify(e.AddOnArray))};let ra=({inValue:e})=>{let a=document.getElementById("TableFooterCategoryId");a!==null&&(a.value=e)},na=({inValue:e})=>{let a=document.getElementById("TableFooterItemNameId");a!==null&&(a.value=e)},da=({inValue:e})=>{let a=document.getElementById("TableFooterItemServiceId");a!==null&&(a.value=e)},ca=({inValue:e})=>{let a=document.getElementById("TableFooterRateInputId");a!==null&&(a.value=e)},ua=({inValue:e})=>{let a=document.getElementById("TableFooterPcsInputId");a!==null&&(a.value=e)},ma=({inValue:e})=>{let a=document.getElementById("TableFooterFactoryInputId");a!==null&&(a.value=e)},sa=({inValue:e})=>{let a=document.getElementById("TableFooterdateInputId");a!==null&&(a.value=e)},Ia=({inValue:e})=>{let a=document.getElementById("SubId");a.classList.remove("d-none"),a!==null&&(a.innerHTML=e),e===void 0&&(a.innerHTML=0)};const ia=()=>{document.getElementById("TableFooterSaveButtonId").classList.add("d-none")};let La=()=>{document.getElementById("TableFooterAlterButtonId").classList.remove("d-none")};const Fa=async({inResponse:e})=>{e.status===200&&oa(await e.json())},ja=async({inItemSerial:e})=>{let t=fa(),a=await la({inRowpk:t,inItemSerial:e});Fa({inResponse:a})},fa=()=>{let e=s.localStorageKeys.OrderKey,t=localStorage.getItem(e);return JSON.parse(t).pk},Sa=(e,t,a)=>{a==="KS-AddOns"&&Xt({inRow:e}),a==="KS-Opts"&&Swal.fire({title:"Check",text:"Do you really want to Delete Item?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Edit",denyButtonText:"Delete"}).then(l=>{l.isConfirmed?ja({inItemSerial:e.pk}):l.isDenied&&ta({inItemSerial:e.pk})})};let Va=()=>{},ga=({inFindColumn:e})=>{e.formatter=ya},ya=(e,t,a)=>a+1;const ba=({inFindColumn:e})=>{e.formatter=Ta},Ta=(e,t)=>{const a=t.AddOnArray;if(a&&a.length>0){const l=a.reduce((o,r)=>o+r.AddOnRate,0);return`<a href="#" class="btn btn-primary ">${a.length}-${l}</a>`}return"No"};let pa=({inFindColumn:e})=>{e.formatter=Oa};function Oa(e,t,a){return['<a href="#" class="link-danger">','<i class="bi bi-trash3"></i>',"</a>"].join("")}let va=({inFindColumn:e})=>{e.formatter=Aa,e.footerFormatter=$a};function Aa(e,t,a){let l=localStorage.getItem("PresentOrder"),o=JSON.parse(l),r=t.ItemSerial,n=Object.values(o.AddOnData).filter(c=>c.AddOnItemSerial===r);return n.length>0?n.map(m=>m.AddOnRate).reduce((m,d)=>m+d,0)*t.Pcs+t.Total:t.Total}function $a(e){return this.field,"₹ "+e.map(function(t){return+t.Total}).reduce(function(t,a){return t+a},0)}let Ba=({inFindColumn:e})=>{e.footerFormatter=""},ha=({inFindColumn:e})=>{e.footerFormatter=Ca};function Ca(e){var t=this.field;return e.map(function(l){return l[t]===void 0?0:+l[t]}).reduce(function(l,o){return l+o},0).toFixed(0)}let Na=({inFindColumn:e})=>{e.formatter=Ea},Ea=(e,t,a)=>new Date(e).toLocaleDateString("en-GB"),Ra=({inColumns:e})=>{let t=e,a=t.find(d=>d.field==="KS-Serial");t.find(d=>d.field==="Rate");let l=t.find(d=>d.field==="KS-AddOns"),o=t.find(d=>d.field==="KS-Opts"),r=t.find(d=>d.field==="KS-Amount"),n=t.find(d=>d.field==="Category");t.find(d=>d.field==="ItemName");let c=t.find(d=>d.field==="Pcs");t.find(d=>d.field==="location");let m=t.find(d=>d.field==="DeliveryDateTime");t.find(d=>d.field==="ItemService"),a!==void 0&&ga({inFindColumn:a}),l!==void 0&&ba({inFindColumn:l}),o!==void 0&&pa({inFindColumn:o}),r!==void 0&&va({inFindColumn:r}),n!==void 0&&Ba({inFindColumn:n}),c!==void 0&&ha({inFindColumn:c}),m!==void 0&&Na({inFindColumn:m})};const Da=(e,t)=>e.ItemService==="PW"?{classes:"table-warning"}:{},Ha=[],wa="true",Ma=[{field:"KS-Serial",title:"#",width:5,widthUnit:"%"},{field:"Category",title:"Category",width:10,widthUnit:"%",visible:!1},{field:"ItemName",title:"Item Name",width:10,widthUnit:"%"},{field:"ItemService",title:"Service",width:10,widthUnit:"%"},{field:"KS-AddOns",title:"Add Ons",width:100},{field:"Rate",title:"Rate",align:"right",footerFormatter:"",width:10,widthUnit:"%"},{field:"Pcs",title:"Pcs",align:"right",width:8,widthUnit:"%"},{field:"KS-Amount",title:"Amount",align:"right",footerFormatter:"",width:15,widthUnit:"%"},{field:"location",title:"Factory",width:200},{field:"DeliveryDateTime",title:"Delivery",width:10,widthUnit:"%"},{field:"KS-Opts",title:"",width:100}],Ka="",Pa="",L={data:Ha,showFooter:wa,columns:Ma,onPostBody:Ka,onClickRow:Pa},Ja=()=>{var e=$("#table");L.onPostBody=Va,L.onClickRow=Sa,L.rowStyle=Da,Ra({inColumns:L.columns}),e.bootstrapTable(L)};let ka=({inRow:e})=>{const t=e;Ua(t.ItemName),xa(t.pk),Wa(t.Rate)},Ua=e=>{let a=document.getElementById("AddOnModalItemNameId");a!==null&&(a.value=e)},xa=e=>{let a=document.getElementById("AddOnModalItemSerialId");a!==null&&(a.value=e)},Wa=e=>{let a=document.getElementById("exampleFormControlInput1");a!==null&&(a.value=e)};const qa=({inRow:e})=>{let t=Ga({inItemSerial:parseInt(e.pk)});var a=$("#AddOnTable");a.bootstrapTable("load",t),ka({inRow:e}),$("#AddOnModal").modal("show")};let Ga=({inItemSerial:e})=>{let t=s.localStorageKeys.OrderKey,a=localStorage.getItem(t),l=JSON.parse(a),o=e;return Object.keys(l.AddOnData).map(c=>S(f({},l.AddOnData[c]),{AddOnPK:c})).filter(c=>c.AddOnItemSerial===o)};const _a=async({inRowpk:e,inItemSerial:t})=>{const a=s.ApiUrls.ItemsTable.DeleteAddOnUrl;let l=localStorage.getItem("BranchName");const o=t;let r=Ya(),n=a.replace("$tableName",l).replace(":Id",e).replace(":SubId",r).replace(":AddOnKey",o);return await fetch(n,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}})};let Ya=()=>{let t=document.getElementById("AddOnModalItemSerialId");if(t!==null)return t.value.trim()};const za=({inResponse:e})=>{e.status===200&&(Qa("AddOnModal"),F().then(t=>{j(),$("#TableFooterItemNameId").focus()}))};function Qa(e){const t=document.querySelector("#"+e),a=bootstrap.Modal.getInstance(t);a!=null&&a.hide()}const Xa=async({inItemSerial:e})=>{let t=Za(),a=await _a({inRowpk:t,inItemSerial:e});za({inResponse:a})},Za=()=>{let e=s.localStorageKeys.OrderKey,t=localStorage.getItem(e);return JSON.parse(t).pk},el=(e,t,a)=>{console.log("row : ",e),a==="KS-AddOns"&&qa({inRow:e}),a==="KS-Opts"&&window.confirm("Do you really want to Delete Item?")&&Xa({inItemSerial:e.AddOnService})};let tl=({inFindColumn:e})=>{e.formatter=al},al=(e,t,a)=>a+1,ll=({inFindColumn:e})=>{e.formatter=ol};function ol(e,t,a){return['<a href="#" class="link-danger">','<i class="bi bi-trash3"></i>',"</a>"].join("")}let rl=({inFindColumn:e})=>{e.footerFormatter=nl};function nl(e){var t=this.field;return e.map(function(l){return l[t]===void 0?0:+l[t]}).reduce(function(l,o){return l+o},0).toFixed(2)}let dl=({inColumns:e})=>{let t=e,a=t.find(r=>r.field==="KS-Serial"),l=t.find(r=>r.field==="KS-Opts"),o=t.find(r=>r.field==="AddOnRate");a!==void 0&&tl({inFindColumn:a}),l!==void 0&&ll({inFindColumn:l}),o!==void 0&&rl({inFindColumn:o})};const cl=[],ul=[{field:"KS-Serial",title:"#",width:75},{field:"AddOnService",title:"Service",width:400},{field:"AddOnRate",title:"Rate",width:200},{field:"KS-Opts",title:"",width:100}],ml="",y={data:cl,columns:ul,onClickRow:ml},sl="AddOnTable",Il=()=>{var e=$(`#${sl}`);y.onClickRow=el,dl({inColumns:y.columns}),e.bootstrapTable(y)};let il=({inRow:e})=>{const t=e;Ll(t.ItemName),Fl(t.pk),jl(t.Rate)},Ll=e=>{let a=document.getElementById("AddOnModalItemNameId");a!==null&&(a.value=e)},Fl=e=>{let a=document.getElementById("AddOnModalItemSerialId");a!==null&&(a.value=e)},jl=e=>{let a=document.getElementById("exampleFormControlInput1");a!==null&&(a.value=e)};const R=()=>{let e=s.localStorageKeys.PresentOrderAddOnsKey,t=localStorage.getItem(e);return JSON.parse(t)},fl=({inAddOnService:e})=>R().find(l=>l.AddOnService===e)===void 0,D=()=>{if(!Sl())return!1;const e=Vl();return fl({inAddOnService:e})!==!1},Sl=()=>{const e=document.getElementById("TableFooterAddOnSelectId");return e.value.trim()?(e.classList.remove("is-invalid"),!0):(e.classList.add("is-invalid"),e.focus(),!1)},Vl=()=>{const e=document.getElementById("TableFooterAddOnSelectId");return e?e.value.trim():void 0},gl=({inRow:e})=>{D();let t=yl({inItemSerial:parseInt(e.pk)});var a=$("#AddOnTable");a.bootstrapTable("load",t),il({inRow:e}),$("#AddOnModal").modal("show")};let yl=({inItemSerial:e})=>{let t=s.localStorageKeys.OrderKey,a=localStorage.getItem(t),l=JSON.parse(a),o=e;return Object.keys(l.AddOnData).map(c=>S(f({},l.AddOnData[c]),{AddOnPK:c})).filter(c=>c.AddOnItemSerial===o)};const bl=({inRowIndex:e})=>{pl({inRowIndex:e}),O(),Tl()};let Tl=()=>{let t=document.getElementById("TableFooterAddOnSelectId");t!==null&&t.focus()};const pl=({inRowIndex:e})=>{let t=s.localStorageKeys.PresentOrderAddOnsKey,a=localStorage.getItem(t),l=JSON.parse(a);l.splice(e,1),localStorage.setItem(t,JSON.stringify(l))},Ol=(e,t,a)=>{if(console.log("row------------ : ",e,t[0].dataset.index,a),a==="KS-AddOns"&&gl({inRow:e}),a==="KS-Opts"&&window.confirm("Do you really want to Delete Item?")){const l=t[0].dataset.index;bl({inRowIndex:parseInt(l)})}},vl=()=>{let e=$l(),t=Al(),a=Bl(),l={};return l.AddOnService=e,l.AddOnRate=parseInt(t),l.AddOnItemSerial=parseInt(a),l};let Al=()=>{let t=document.getElementById("AddOnRateId");return t===null||t.value.trim()===""?0:t.value.trim()},$l=()=>{let t=document.getElementById("TableFooterAddOnSelectId");if(t!==null)return t.value.trim()},Bl=()=>{let t=document.getElementById("AddOnModalItemSerialId");if(t!==null)return t.value.trim()};const hl=()=>{const e=vl();Cl({inAddOnRow:e})},Cl=({inAddOnRow:e})=>{let t=s.localStorageKeys.PresentOrderAddOnsKey,a=localStorage.getItem(t);if(a===null){localStorage.setItem(t,JSON.stringify([e]));return}let l=JSON.parse(a);l.push(e),localStorage.setItem(t,JSON.stringify(l))},Nl=()=>{const e=D();console.log(" : ",e),e?(hl(),O(),El()):Rl()};let El=()=>{let t=document.getElementById("TableFooterAddOnSelectId");t!==null&&t.focus()};const Rl=()=>{const e=document.getElementById("TableFooterAddOnSelectId");e.classList.add("is-invalid"),e.addEventListener("click",()=>e.classList.remove("is-invalid"))};let Dl=()=>{let e=document.getElementById("AddOnModalSaveButtonId");e!==null&&e.addEventListener("click",Nl)};const Hl=()=>{let e=s.localStorageKeys.AddOnsKey,t=localStorage.getItem(e);return JSON.parse(t)},wl=()=>{let e=document.getElementById("TableFooterAddOnSelectId");Ml(e);let t=Hl();for(var a=0;a<t.length;a++){let l=document.createElement("option");l.value=t[a].AddOnService,l.innerHTML=t[a].AddOnService,e.appendChild(l)}};let Ml=e=>{let t=document.createElement("option");t.value="",t.innerHTML="Select Add-On ",e.appendChild(t)};const Kl="AddOns",Pl=()=>{const e=event.currentTarget,t=kl({inAddOnData:e.value});Ul(t)},Jl=()=>{const e=localStorage.getItem(Kl);return JSON.parse(e)},kl=({inAddOnData:e})=>{const a=Jl().find(l=>l.AddOnService===e);return a===void 0?0:a.AddOnRate};let Ul=e=>{let a=document.getElementById("AddOnRateId");a!==null&&(a.value=e)};const xl=e=>{e.currentTarget,e.key==="Enter"&&Wl()};let Wl=()=>{var e=new Event("click");let t=document.getElementById("AddOnModalSaveButtonId");t!==null&&t.dispatchEvent(e)},ql=()=>{let e=document.getElementById("TableFooterAddOnSelectId");e!==null&&e.addEventListener("change",Pl),e!==null&&e.addEventListener("keypress",xl)},Gl=()=>{Dl(),wl(),ql(),_l(),$("#TableFooterItemNameId").focus()},_l=()=>{var e=new Event("change");let t=document.getElementById("TableFooterAddOnSelectId");t!==null&&t.dispatchEvent(e)},Yl=({inFindColumn:e})=>{e.formatter=zl},zl=(e,t,a)=>a+1,Ql=({inFindColumn:e})=>{e.footerFormatter=Xl},Xl=e=>`<input type="number" name="AddOnRate" id="AddOnRateId" class="form-control"
                                placeholder="AddOn Rate">`,Zl=({inFindColumn:e})=>{e.formatter=eo,e.footerFormatter=to};function eo(e,t,a){return['<a href="#" class="btn btn-danger ">','<i class="bi bi-trash3"></i>',"</a>"].join("")}const to=e=>`   <button type="button" class="btn btn-primary" id="AddOnModalSaveButtonId">
                                Save
                            </button>`;let ao=({inFindColumn:e})=>{e.footerFormatter=lo};const lo=(e,t,a)=>`  <select class="form-select" aria-label="Select AddOn" id="TableFooterAddOnSelectId">
                            </select>`;let oo=({inColumns:e})=>{let t=e,a=t.find(n=>n.field==="KS-Serial"),l=t.find(n=>n.field==="KS-Opts"),o=t.find(n=>n.field==="AddOnService"),r=t.find(n=>n.field==="AddOnRate");a!==void 0&&Yl({inFindColumn:a}),l!==void 0&&Zl({inFindColumn:l}),o!==void 0&&ao({inFindColumn:o}),r!==void 0&&Ql({inFindColumn:r})};const ro=[],no=[{field:"KS-Serial",title:"#",width:75},{field:"AddOnService",title:"Service",width:400},{field:"AddOnRate",title:"Rate",width:200},{field:"KS-Opts",title:"Options",width:100}],co="",uo="",V={data:ro,columns:no,onPostBody:co,onClickRow:uo},mo="AddOnModalLocalStorage",so=()=>{let t=document.getElementById(mo).querySelector("table");var a=$(t);V.onPostBody=Gl,V.onClickRow=Ol,oo({inColumns:V.columns}),a.bootstrapTable(V)},Io=()=>{Ja(),Il(),so()},io=async()=>{Ce(),Io(),await Gt(),Wt()},Lo=()=>{let e=s.localStorageKeys.OrderKey,t=localStorage.getItem(e);return JSON.parse(t)},Fo=()=>{let e=Lo();Vo(e.CustomerData.CustomerMobile),So(e.CustomerData.CustomerName),fo(e.pk),jo(localStorage.getItem("BranchName"))};let jo=e=>{let a=document.getElementById("BranchNameAnchorId"),l=e.replace("BranOrders","");a!==null&&(a.innerHTML=l)},fo=e=>{let a=document.getElementById("OrderNumberId");a!==null&&(a.innerHTML=e)},So=e=>{let a=document.getElementById("CustomerNameId");a!==null&&(a.value=e)},Vo=e=>{let a=document.getElementById("CustomerMobileId");a!==null&&(a.value=e)};const N=()=>{j(),Fo()},go=()=>{let e=s.localStorageKeys.PresentOrderAddOnsKey;R()===null&&localStorage.setItem(e,JSON.stringify([]))},yo=async()=>{await io(),J({inSuccessFunc:N})&&(go(),N())};yo().then();
