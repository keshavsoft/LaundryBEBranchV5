var N=Object.defineProperty,y=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var V=(t,e,a)=>e in t?N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,A=(t,e)=>{for(var a in e||(e={}))p.call(e,a)&&V(t,a,e[a]);if(j)for(var a of j(e))v.call(e,a)&&V(t,a,e[a]);return t},L=(t,e)=>y(t,B(e));import{S as P}from"./EntryFile-D68kwv0T.js";/* empty css              */import{C as S}from"./Config-3hNwyP2N.js";const R="binV4",U="Transactions",E="Kakinada",$={OrderKey:"PresentOrder",ItemNamesKey:"ItemNames",AddOnsKey:"AddOns"},H={routePath:R,folderName:U,tableName:E,localStorageKeys:$};let T=async({inSettlementData:t})=>{let e=localStorage.getItem("BranchName"),a=t.inDataToUpdate,l=`/${H.routePath}/${e}/SubTable/Create/${t.MainRowPK}/${t.InsertKey}`,o={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)};return await(await fetch(l,o)).json()},b=()=>{w({inGetKey:"BranchName"});let t={};t.DiscountAmount=parseFloat(K())||0,t.CGST=parseFloat(k())||0,t.SGST=parseFloat(M())||0;let e={};return e.MainRowPK=Q(),e.InsertKey="CheckOutData",e.inDataToUpdate={},e.inDataToUpdate.RoundOff=parseFloat(z())||0,e.inDataToUpdate.CashAmount=parseInt(G())||0,e.inDataToUpdate.CardAmount=parseInt(q())||0,e.inDataToUpdate.UPIAmount=parseInt(J())||0,e.inDataToUpdate.DiscountPer=parseInt(x())||0,e.inDataToUpdate.GstData=t,e},w=({inGetKey:t})=>{const e=window.location.search;return new URLSearchParams(e).get(t)},k=()=>document.getElementById("CgstAmountId").value.trim(),M=()=>document.getElementById("SgstAmountId").value.trim(),K=()=>document.getElementById("DiscountAmountId").value.trim(),x=()=>document.getElementById("DiscountPerId").value.trim(),G=()=>document.getElementById("CashAmountId").value.trim(),q=()=>document.getElementById("CardAmountId").value.trim(),J=()=>document.getElementById("UPIAmountId").value.trim(),Q=()=>document.getElementById("OrderNumberId").innerHTML.trim(),z=()=>document.getElementById("RoundOffId").value.trim(),W=()=>{let t=parseInt(f())||0,e=parseInt(O())||0,a=parseInt(g())||0;parseInt(Y());let l=parseFloat(C())||0,o=parseFloat(Z())||0,r=parseFloat(F())||0,m=t+e+a;return s().classList.remove("is-invalid"),o>10?(s().focus(),s().classList.add("is-invalid"),!1):X()===!1?!1:m!==r+l?t===0?(u().focus(),u().classList.add("is-invalid"),!1):(u().classList.contains("is-invalid")&&(u().classList.remove("is-invalid"),u().classList.add("is-valid")),e===0?(I().focus(),I().classList.add("is-invalid"),!1):(I().classList.contains("is-invalid")&&(I().classList.remove("is-invalid"),I().classList.add("is-valid")),a===0?(c().focus(),c().classList.add("is-invalid"),!1):(c().classList.contains("is-invalid")&&(c().classList.remove("is-invalid"),c().classList.add("is-valid")),e>0&&a>0&&(u().focus(),u().classList.add("is-invalid")),!1))):!0},X=()=>{let t=parseFloat(F())||0,e=parseFloat(C())||0,a=parseInt(f())||0,l=parseInt(O())||0,o=parseInt(g())||0;if(a+l+o<t+e){let m=document.getElementById("AmountCheckAlert");return m.classList.remove("d-none"),m.classList.add("show"),!1}},u=()=>document.getElementById("CashAmountId"),I=()=>document.getElementById("CardAmountId"),c=()=>document.getElementById("UPIAmountId"),f=()=>document.getElementById("CashAmountId").value.trim(),C=()=>document.getElementById("RoundOffId").value.trim(),F=()=>document.getElementById("NettAmountId").value.trim(),s=()=>document.getElementById("DiscountPerId"),O=()=>document.getElementById("CardAmountId").value.trim(),g=()=>document.getElementById("UPIAmountId").value.trim(),Y=()=>document.getElementById("OrderAmountId").innerHTML,Z=()=>document.getElementById("DiscountPerId").value.trim(),_=({inFromFetch:t})=>{t&&Swal.fire({title:"Settlement Success",confirmButtonText:"Ok"}).then(e=>{e.isConfirmed&&tt()})},tt=()=>{const t=S.urls.SaveButtonId.redirectToUrl,e=new URL(window.location.href);let a=new URL(t,e);window.location.href=a.href},et=async()=>{if(W()){let t=b(),e=await T({inSettlementData:t});_({inFromFetch:e})}};const at=()=>{(()=>{var a=document.querySelector("#AmountCheckAlert .close");a.addEventListener("click",()=>{document.getElementById("AmountCheckAlert").style.display="none"})})();let e=document.getElementById("SaveButtonId");e!==null&&e.addEventListener("click",et)};let h=document.getElementById("DiscountPerId"),lt=()=>{h.addEventListener("keyup",ot)};const ot=rt(()=>nt());function rt(t,e=300){let a;return(...l)=>{clearTimeout(a),a=setTimeout(()=>{t.apply(this,l)},e)}}function nt(){let t=D(),e=document.getElementById("DiscountAmountId");e.value=(t*h.value/100).toFixed(2),Lt({inCgstAmountId:((t-e.value)*(9/100)).toFixed(2)}),At({inSgstAmountId:((t-e.value)*(9/100)).toFixed(2)}),mt()}let mt=()=>{let t=D(),e=document.getElementById("DiscountAmountId"),a=t-e.value,l=st(),o=jt();Vt({inNettAmountId:parseFloat(a)+parseFloat(l)+parseFloat(o)});let r=parseFloat(dt());ct({inRoundOffId:(Math.round(r)-r).toFixed(2)});let m=parseFloat(ut()),n=r+m;It({inTotalNetAmountId:n})},dt=()=>document.getElementById("NettAmountId").value.trim(),ut=()=>document.getElementById("RoundOffId").value.trim(),It=({inTotalNetAmountId:t})=>{let a=document.getElementById("TotalNetAmountId");a.innerHTML=t},ct=({inRoundOffId:t})=>{let a=document.getElementById("RoundOffId");a.value=t},st=()=>document.getElementById("SgstAmountId").value.trim(),jt=()=>document.getElementById("CgstAmountId").value.trim(),Vt=({inNettAmountId:t})=>{let a=document.getElementById("NettAmountId");a.value=t.toFixed(2)},At=({inSgstAmountId:t})=>{let a=document.getElementById("SgstAmountId");a.value=t},Lt=({inCgstAmountId:t})=>{let a=document.getElementById("CgstAmountId");a.value=t},D=()=>document.getElementById("OrderAmountId").innerHTML,it=()=>{let t=Ht(),e=ft(),a=Ot()||0,l=Ft()||0,o=parseInt(a)+parseInt(l),r=parseFloat(t)+parseFloat(e)-o;Ct({injVarCashAmount:r})},Ht=()=>document.getElementById("NettAmountId").value,ft=()=>document.getElementById("RoundOffId").value,Ct=({injVarCashAmount:t})=>{let a=document.getElementById("CashAmountId");a.value=t},Ft=()=>document.getElementById("UPIAmountId").value,Ot=()=>document.getElementById("CardAmountId").value;const gt=()=>{let t=document.getElementById("CashAmountButtonId");t!==null&&t.addEventListener("click",it)};let ht=()=>{let t=Dt(),e=Nt(),a=Bt()||0,l=pt()||0,o=parseInt(a)+parseInt(l),r=parseFloat(t)+parseFloat(e)-o;yt({injVarCardAmount:r})},Dt=()=>document.getElementById("NettAmountId").value,Nt=()=>document.getElementById("RoundOffId").value,yt=({injVarCardAmount:t})=>{let a=document.getElementById("CardAmountId");a.value=t},Bt=()=>document.getElementById("CashAmountId").value,pt=()=>document.getElementById("UPIAmountId").value;const vt=()=>{let t=document.getElementById("CardAmountButtonId");t!==null&&t.addEventListener("click",ht)};let Pt=()=>{let t=St(),e=Rt(),a=Et()||0,l=$t()||0,o=parseInt(a)+parseInt(l),r=parseFloat(t)+parseFloat(e)-o;Ut({injVarUPIAmount:r})},St=()=>document.getElementById("NettAmountId").value,Rt=()=>document.getElementById("RoundOffId").value,Ut=({injVarUPIAmount:t})=>{let a=document.getElementById("UPIAmountId");a.value=t},Et=()=>document.getElementById("CashAmountId").value,$t=()=>document.getElementById("CardAmountId").value;const Tt=()=>{let t=document.getElementById("UPIAmountButtonId");t!==null&&t.addEventListener("click",Pt)};let bt=()=>{at(),lt(),gt(),vt(),Tt()},wt=()=>{bt()},kt=async({inParams:t})=>{let e=t.inPk,a=t.BranchName,l=`/${H.routePath}/${a}/Show/Filter/pk/${e}`,o=await fetch(l);console.log("response");let r=await o.json();return console.log("jVarLocalResponse"),r},Mt=({inData:t})=>{let e=[t].map(a=>{let l=Object.values(a.AddOnData),o=Object.values(a.ItemsInOrder);return xt({inAddOn:l,inItems:o})});Kt({inOrderAmountId:e})},Kt=({inOrderAmountId:t})=>{let a=document.getElementById("OrderAmountId");a.innerHTML=t};const xt=({inAddOn:t,inItems:e})=>{let a=t,l=e;const o=a.reduce((n,d)=>(n[d.AddOnItemSerial]||(n[d.AddOnItemSerial]=0),n[d.AddOnItemSerial]+=d.AddOnRate,n),{});return l.map(n=>{const d=o[n.ItemSerial]||0;return L(A({},n),{Total:n.Total+d*n.Pcs})}).map(n=>n.Total).reduce((n,d)=>n+d,0)},Gt=({inData:t})=>{let e=t;console.log("data: ",e),Jt({inOrderInfoCustomerNameId:e.CustomerData.CustomerName}),Wt({inOrderInfoCustomerMobileId:e.CustomerData.CustomerMobile}),Qt({inOrderInfoCustomerBranchId:e.OrderData.BranchName}),zt({inOrderDate:e.OrderData.Currentdateandtime}),qt({inOrderNumberId:e.pk})};let qt=({inOrderNumberId:t})=>{let a=document.getElementById("OrderNumberId");a.innerHTML=t},Jt=({inOrderInfoCustomerNameId:t})=>{let a=document.getElementById("OrderInfoCustomerNameId");a.value=t},Qt=({inOrderInfoCustomerBranchId:t})=>{let a=document.getElementById("BranchNameId");a.value=t},zt=({inOrderDate:t})=>{let a=document.getElementById("OrderDate"),l=t.split(" ")[0];a.value=l},Wt=({inOrderInfoCustomerMobileId:t})=>{let a=document.getElementById("OrderInfoCustomerMobileId");a.value=t};const Xt=({inData:t})=>{let e=t;if(!("CheckOutData"in e))return"";let a=Object.values(e.CheckOutData)[0];if(a===void 0)return"";Yt({inCashAmountId:a.CashAmount}),Zt({inCashAmountId:a.UPIAmount}),_t({inCashAmountId:a.CardAmount}),te({inDiscountPerId:a.DiscountPer})};let Yt=({inCashAmountId:t})=>{let a=document.getElementById("CashAmountId");a.value=t},Zt=({inCashAmountId:t})=>{let a=document.getElementById("UPIAmountId");a.value=t},_t=({inCashAmountId:t})=>{let a=document.getElementById("CardAmountId");a.value=t},te=({inDiscountPerId:t})=>{let a=document.getElementById("DiscountPerId");a.value=t};const ee=({inFromFetch:t})=>{Mt({inData:t[0]}),Gt({inData:t[0]}),Xt({inData:t[0]})};let ae=async({inParams:t})=>{{let e=await kt({inParams:t});ee({inFromFetch:e})}},le=async({inParams:t})=>{ae({inParams:t})};const oe=({inParams:t})=>{le({inParams:t})};let re=()=>{let t=localStorage.getItem("BranchName"),e=ne({inGetKey:"OrderNumber"}),a={};if(a.BranchName=t,a.inPk=e,t===null||t===""){Swal.fire({title:"BranchName!",text:"Not found in URL!",icon:"error"});return}if(e===null||t===""){Swal.fire({title:"OrderNumber!",text:"Not found in URL!",icon:"error"});return}oe({inParams:a})},ne=({inGetKey:t})=>{const e=window.location.search;return new URLSearchParams(e).get(t)};const i=()=>{re(),wt(),me()};let me=()=>{let t=new Event("keyup");document.getElementById("DiscountPerId").dispatchEvent(t)};const de=()=>{P({inSuccessFunc:i})&&i()};de();
