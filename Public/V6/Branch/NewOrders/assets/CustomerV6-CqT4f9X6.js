import{S as D}from"./EntryFile-D68kwv0T.js";import{C as O}from"./Config-kioEcG-G.js";const h=()=>{let t=localStorage.getItem("CustomerNames");if(t===null){document.getElementById("MasterButtonId").click();return}let e=JSON.parse(t),a=document.getElementById("CustomersDataListId");e.forEach(l=>{let o=document.createElement("option");o.value=`${l.CustomerName}:${l.Mobile}`,o.innerHTML=`${l.CustomerName}:${l.Mobile}`,a.appendChild(o)})},w="POST",N={Accept:"application/json","Content-Type":"application/json"},A="",g={method:w,headers:N,body:A},T=()=>{let t=document.getElementById("CustomerNameInputId");console.log(t.value);let a=t.value.replace(/\D/g,""),l={};return l.FindKey="e.CustomerData.CustomerMobile",l.FindValue=a,l};let B=()=>(g.body=JSON.stringify(T()),g);const v="binV4",E="Masters",R="CustomerNames",M={OrderKey:"CustomerNames",ItemNamesKey:"ItemNames",AddOnsKey:"AddOns"},k={NewOrderButtonId:{PostFetch:"/Custom/Cleaning/Branch/Order/NewOrderV1/InSertOrder",RedirectUrl:{"500Status":"/Laundry/Branch/NewOrders/HtmlFiles/AddItems.html","200Status":"AddItems.html"}},AddItemsButtonId:{PostFetch:"/Custom/Cleaning/Branch/Order/NewOrder",RedirectUrl:{"500Status":"/Laundry/Branch/NewOrders/HtmlFiles/AddItems.html","200Status":"AddItemsTotalRight.html"}}},u={routePath:v,folderName:E,tableName:R,localStorageKeys:M,Urls:k};let H=async()=>{let t=u.routePath,e=localStorage.getItem("BranchName"),a=B(),l=`/${t}/${e}/Show/FilterDataFromBody`;return await await fetch(l,a)};const S=()=>{let t=O.localStorageKeys.CustomerOrderKey,e=localStorage.getItem(t);return JSON.parse(e)},P=({inOrdersArray:t})=>{let e=O.localStorageKeys.CustomerOrderKey;S()===null&&localStorage.setItem(e,JSON.stringify([])),localStorage.setItem(e,JSON.stringify(t))};let x=t=>{let e=t.JsonData,a=J({inData:e});P({inOrdersArray:a});let l=new Date().toISOString().split("T")[0],n=a.filter(s=>new Date(s.DateTime).toISOString().split("T")[0]===l).sort((s,i)=>s.pk===i.pk?0:s.pk<i.pk?1:-1);var c=$("#table");c.bootstrapTable("load",n),U(),K()},J=({inData:t})=>{let e=t,a=[];return a=e.map(l=>{l.AggValues={},l.AggValues.ItemDetails=`${Object.keys(l.ItemsInOrder).length} / ${Object.values(l.ItemsInOrder).map(n=>n.Pcs).reduce((n,c)=>n+parseInt(c),0)}`,l.AggValues.SettlementAmount="",Object.values(l.CheckOutData)[0]&&(l.AggValues.SettlementAmount=Object.values(l.CheckOutData)[0].CardAmount+Object.values(l.CheckOutData)[0].CashAmount+Object.values(l.CheckOutData)[0].UPIAmount,l.IsSettled=!1),Object.keys(l.CheckOutData).length>0&&(l.IsSettled=!0);let o=Object.values(l.AddOnData);return l.AggValues.ItemsArray=Object.values(l.ItemsInOrder).map(n=>(n.AddOnDataAsArray=o.filter(c=>c.AddOnItemSerial===n.ItemSerial),n)),l}),a},K=()=>{document.getElementById("ThisWeekRefreshButtonId").click()},U=()=>{document.getElementById("YesterdayRefreshButtonId").click()},z=async()=>{let t=await H();t.status===200&&x(await t.json())};const p=()=>{z()};let G=()=>{document.getElementById("CustomerNameInputId").addEventListener("keypress",a=>{a.key==="Enter"&&p()})},Y=async()=>{let t=document.getElementById("CustomerNameInputId");if(t.value==="")return t.classList.add("is-invalid"),!1;let e=await W();return console.log("LocalFech:",e),e===!1?(t.classList.add("is-invalid"),!1):!0};const W=async()=>{let e=document.getElementById("CustomerNameInputId").value.split(":")[1],a=`/${u.routePath}/MastersCustomers/Show/Filter/Mobile/${e}`;return(await fetch(a)).status!==500};let X=async()=>{let e=q().split(":")[1],a=localStorage.getItem("BranchName"),l=`${u.Urls.NewOrderButtonId.PostFetch}/${a}/${e}`;return await await fetch(l)},q=()=>{let e=document.getElementById("CustomerNameInputId");if(e!==null)return e.value.trim()},Q=()=>{window.location=u.Urls.NewOrderButtonId.RedirectUrl["200Status"]},Z=({inresponse:t})=>{Swal.fire({title:"Error Alert",text:`${t}`,icon:"error",confirmButtonColor:"#3085d6",showDenyButton:!0,denyButtonText:"Add ItemsV1",denyButtonColor:"#008000"}).then(e=>{(e.isConfirmed||e.isDismissed)&&(window.location.href=""),e.isDenied&&(window.location.href=u.Urls.NewOrderButtonId.RedirectUrl["500Status"])})},_=async()=>{let t=await X();t.status===200&&Q(),t.status===500&&Z({inresponse:await t.text()})};const tt=async()=>{await Y()&&_()};let et=()=>{document.getElementById("NewOrderButtonId").addEventListener("click",tt)},at=()=>{document.getElementById("CustomerNameSearchButtonId").addEventListener("click",p)},lt=async()=>{let t=u.routePath,e=u.localStorageKeys.OrderKey,a=`/${t}/MastersCustomers/Show/DataOnly`,o=await(await fetch(a)).json();localStorage.setItem(e,JSON.stringify(o))},ot=async()=>{let t=u.routePath,e=u.localStorageKeys.ItemNamesKey,a=`/${t}/MastersItems/Show/DataOnly`,o=await(await fetch(a)).json();localStorage.setItem(e,JSON.stringify(o))},rt=async()=>{let t=u.routePath,e=u.localStorageKeys.AddOnsKey,a=`/${t}/MastersAddOns/Show/DataOnly`,o=await(await fetch(a)).json();localStorage.setItem(e,JSON.stringify(o))},nt=()=>{lt().then(()=>{ct()}),ot().then(),rt().then(()=>location.reload())};const ct=()=>{let t=localStorage.getItem("CustomerNames");if(t!==null){let e=JSON.parse(t),a=document.getElementById("CustomersDataListId");a.innerHTML="",e.forEach(l=>{let o=document.createElement("option");o.value=`${l.CustomerName}:${l.Mobile}`,o.innerHTML=`${l.CustomerName}:${l.Mobile}`,a.appendChild(o)})}};let st=()=>{document.getElementById("MasterButtonId").addEventListener("click",()=>{nt()})},it=()=>{const e=localStorage.getItem("BranchName").replace("BranOrders","");let a=document.getElementById("BranchButtonId");a.innerText=e,a.addEventListener("click",function(){window.location.href="/LoginUsers/HtmlFiles/loginBranch.html"})},dt=async()=>{let t=document.getElementById("CustomerNameInputId");if(t.value==="")return t.classList.add("is-invalid"),!1;let e=await ut();return console.log("LocalFech:",e),e===!1?(t.classList.add("is-invalid"),!1):!0};const ut=async()=>{let e=document.getElementById("CustomerNameInputId").value.split(":")[1],a=`/${u.routePath}/MastersCustomers/Show/Filter/Mobile/${e}`;return(await fetch(a)).status!==500},mt="POST",ft={Accept:"application/json","Content-Type":"application/json"},Lt={ItemsInOrder:{},CustomerData:{CustomerName:"",CustomerMobile:""},OrderData:{BranchName:"",Currentdateandtime:""},AddOnData:{},CheckOutData:{}},m={method:mt,headers:ft,body:Lt};let It=()=>{let t=Ft(),e=t.split(":")[1],a=t.split(":")[0],l=localStorage.getItem("BranchName");return m.body.CustomerData.CustomerMobile=e,m.body.CustomerData.CustomerName=a,m.body.OrderData.BranchName=l,m.body.OrderData.Currentdateandtime=jt(),m.body=JSON.stringify(m.body),m},Ft=()=>{let e=document.getElementById("CustomerNameInputId");if(e!==null)return e.value.trim()},jt=()=>{let t=new Date,e=new Date(t),a=(e.getSeconds()<10?"0":"")+e.getSeconds(),l=(e.getMinutes()<10?"0":"")+e.getMinutes(),o=(e.getHours()<10?"0":"")+e.getHours(),n=(e.getDate()<10?"0":"")+e.getDate(),c=(e.getMonth()+1<10?"0":"")+(e.getMonth()+1);return`${e.getFullYear()}-${c}-${n} ${o}:${l}:${a}`},Vt=async()=>{let t=It(),e=localStorage.getItem("BranchName"),a=`${u.Urls.AddItemsButtonId.PostFetch}/${e}`;return await await fetch(a,t)},St=()=>{const t=document.getElementById("AddItemsHtmlId").value;t==="AddRight"?window.location.href="./AddItemsTotalRight.html":t==="AddBottom"&&(window.location.href="./AddItemsButtom.html")},pt=({inresponse:t})=>{Swal.fire({title:"Error Alert",text:`${t}`,icon:"error",confirmButtonColor:"#3085d6",showDenyButton:!0,denyButtonText:"Add ItemsV1",denyButtonColor:"#008000"}).then(e=>{(e.isConfirmed||e.isDismissed)&&(window.location.href=""),e.isDenied&&(window.location.href=u.Urls.NewOrderButtonId.RedirectUrl["500Status"])})},$t=async()=>{let t=await Vt();t.status===200&&St(await t.json()),t.status===500&&pt({inresponse:await t.text()})};const ht=async()=>{await dt()&&$t()};let gt=()=>{document.getElementById("AddItemsButtonId").addEventListener("click",ht)},Ct=()=>{let t=S(),e=bt(),a=t.filter(o=>new Date(o.DateTime).toLocaleDateString("en-GD")==e);var l=$("#YesterdayTableId");l.bootstrapTable("load",a)};function bt(){const t=new Date,e=new Date(t);return e.setDate(t.getDate()-1),(o=>{const n=o.getFullYear(),c=String(o.getMonth()+1).padStart(2,"0");return`${String(o.getDate()).padStart(2,"0")}/${c}/${n}`})(e)}let yt=()=>{document.getElementById("YesterdayRefreshButtonId").addEventListener("click",Ct)},Ot=()=>{let t=S();const e=new Date,a=new Date;a.setDate(e.getDate()-7);const l=t.filter(n=>{const c=new Date(n.DateTime);return c>=a&&c<=e});var o=$("#ThisWeekTableId");o.bootstrapTable("load",l)},Dt=()=>{document.getElementById("ThisWeekRefreshButtonId").addEventListener("click",Ot)},wt=()=>{yt(),Dt()};const Nt="/binV4/MastersCustomers/Show/Filter/Mobile/{MobileNumber}",At={GetEndPoint:Nt};let Tt=async()=>{let t=At.GetEndPoint;const a=Bt().split(":")[1].trim(),l=t.replace("{MobileNumber}",a);return await await fetch(l)},Bt=()=>{let e=document.getElementById("CustomerNameInputId");if(e!==null)return e.value.trim()},vt=({inData:t})=>{Et({inValue:t.pk}),Rt({inValue:t.CustomerName}),Mt({inValue:t.Mobile}),kt({inValue:t.DOB}),Pt({inValue:t.City}),xt({inValue:t.Occupation}),Jt({inValue:t.CompanyName}),Ht({inValue:t.GSTNumber})},Et=({inValue:t})=>{let a=document.getElementById("pkId");a!==null&&(a.value=t)},Rt=({inValue:t})=>{let a=document.getElementById("CustomerName");a!==null&&(a.value=t)},Mt=({inValue:t})=>{let a=document.getElementById("CustomerMobileNumber");a!==null&&(a.value=t)},kt=({inValue:t})=>{let a=document.getElementById("dob");a!==null&&(a.value=t)},Ht=({inValue:t})=>{let a=document.getElementById("CustomerGST");a!==null&&(a.value=t)},Pt=({inValue:t})=>{let a=document.getElementById("CustomerLocation");a!==null&&(a.value=t)},xt=({inValue:t})=>{let a=document.getElementById("CustomerOccupation");a!==null&&(a.value=t)},Jt=({inValue:t})=>{let a=document.getElementById("CustomerCompany");a!==null&&(a.value=t)},Kt=({inData:t})=>{vt({inData:t})},Ut=({inResponse:t})=>{Swal.fire({text:`${t}`,icon:"error",title:"check"})},zt=async({inResponse:t})=>{let e=await t;if(e.status===200){let a=await e.json();Kt({inData:a[0]})}if(e.status===500){let a=await e.text();Ut({inResponse:a})}};const Gt=async()=>{let t=await Tt();zt({inResponse:t})};let Yt=()=>{document.getElementById("CustomerAlter").addEventListener("click",Gt)},Wt=()=>{Yt()};const Xt="PUT",qt={Accept:"application/json","Content-Type":"application/json"},Qt="",C={method:Xt,headers:qt,body:Qt};let Zt=()=>{let t=document.getElementById("FormId");return C.body=JSON.stringify(_t(t)),C};function _t(t){var e=new FormData(t),a={};for(var[l,o]of e)a[l]?(Array.isArray(a[l])||(a[l]=[a[l]]),a[l].push(o)):a[l]=o;return a}const te="binV4",ee="MastersCustomers",b={routePath:te,tableName:ee};let ae=async()=>{let t=b.routePath,e=b.tableName,a=le(),l=Zt(),o=`/${t}/${e}/Alter/${a}`;return await await fetch(o,l)},le=()=>{let e=document.getElementById("pkId");if(e!==null)return e.value.trim()},oe=()=>{let e=document.getElementById("FormId").querySelectorAll("[required]"),a=!0;return e.forEach(l=>{if(l.value.trim().length===0){l.classList.add("is-invalid"),a=!1;return}if(l.value.trim().length>0&&l.classList.remove("is-invalid"),l.name==="Mobile"&&l.value.trim().length!==10){document.getElementById("MobileClass").innerHTML="must be 10",l.classList.add("is-invalid"),l.focus(),a=!1;return}if(l.name==="AddOnRate"&&!(l.value.trim().length<4)){a=!1;return}}),a},re=({inFetchData:t})=>{$("#editCustomerModal").modal("hide")},ne=async()=>{if(oe()){let e=await ae();re({inResponse:e})}},ce=()=>{let t=document.getElementById("ModelAlter");t!==null&&t.addEventListener("click",ne)},se=()=>{ce()},ie=()=>{G(),et(),at(),st(),it(),gt(),wt(),Wt(),se()};const de=()=>{let t=y({inGetKey:"CustomerMobile"}),e=y({inGetKey:"CustomerName"});if(t!==null&&e!==null){let a=`${e}:${t}`;ue(a)}};let ue=t=>{let a=document.getElementById("CustomerNameInputId");a!==null&&(a.value=t)},y=({inGetKey:t})=>{const e=window.location.search;return new URLSearchParams(e).get(t)},me=(t,e,a)=>{let l=e.AddOnDataAsArray,n=document.getElementById("TemplateForAddOns").content.cloneNode("true");const s=new XMLSerializer().serializeToString(n);a.html(s).find("table").bootstrapTable({data:l})};const fe="#toolbar",Le="pk",Ie="true",Fe=[],je=!0,Ve="",Se="",pe="",$e=[{field:"KS-Serial",title:"#"},{field:"ItemName",title:"ItemName"},{field:"Rate",title:"Rate"},{field:"Pcs",title:"Pcs"}],F={toolbar:fe,idfield:Le,showFooter:Ie,data:Fe,detailView:je,onClickRow:Ve,onExpandRow:Se,icons:pe,columns:$e};let he=(t,e,a)=>{let l=e.AggValues.ItemsArray,n=document.getElementById("TemplateForItemNames").content.cloneNode("true");const s=new XMLSerializer().serializeToString(n);let i=a.html(s).find("table");F.data=l,F.onExpandRow=me,i.bootstrapTable(F)};const ge="bi-plus-circle fs-4",Ce="bi-dash-circle fs-4",be={detailOpen:ge,detailClose:Ce},ye="#toolbar",Oe="pk",De="true",we=[],Ne=!0,Ae="",Te="",Be="",ve=[{field:"pk",title:"Order#"},{field:"OrderData.Currentdateandtime",title:"Date",formatter:"LocalDate",visible:!1},{field:"DateTime",title:"Time Span",formatter:"TimeDiff",class:"d-none d-sm-table-cell"},{field:"AggValues.ItemDetails",title:"Items",footerFormatter:"ItemsFormatter",class:"d-none d-sm-table-cell"},{field:"AggValues.SettlementAmount",title:"Settlement",footerFormatter:"priceFormatter",align:"right",class:"d-none d-sm-table-cell"},{field:"IsSettled",title:"IsSettled"},{title:"Opts.",field:"Opts",align:"center",formatter:""}],f={toolbar:ye,idfield:Oe,showFooter:De,data:we,detailView:Ne,onClickRow:Ae,onExpandRow:Te,icons:Be,columns:ve};let Ee=async({inFromFetch:t})=>{t.KTF===!1?Swal.fire({icon:"warning",text:t.KReason}):p()};const Re=async({inRowData:t})=>{let e=t.pk,l=`/Custom/Cleaning/Branch/Today/Orders/${localStorage.getItem("BranchName")}/${e}`,c=await(await fetch(l,{method:"delete",headers:{Accept:"application/json","Content-Type":"application/json"}})).json();return Ee({inFromFetch:c}),c};let Me=async({inRowData:t})=>{Swal.fire({title:"Are you sure to delete?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Delete",focusCancel:!0,focusButtonColor:"#0000ff"}).then(e=>{e.isConfirmed&&Re({inRowData:t}).then(a=>{})})};const ke=(t,e,a)=>{a==="Opts"&&(t.IsSettled||Me({inRowData:t}))};let He=({inFindColumn:t})=>{t.formatter=Pe},Pe=(t,e,a)=>a+1,xe=({inFindColumn:t})=>{t.footerFormatter=Ke,t.formatter=Je};const Je=(t,e,a)=>t===""?"":`₹ ${t}`;function Ke(t){return console.log("data : ",t),"₹ "+t.map(function(e){return+e.AggValues.SettlementAmount}).reduce(function(e,a){return e+a},0)}const Ue=({inFindColumn:t})=>{t.formatter=ze},ze=(t,e)=>{const a=e.AddOnArray;if(a&&a.length>0){const l=a.reduce((o,n)=>o+n.AddOnRate,0);return`<a href="#" class="btn btn-primary ">${a.length}-${l}</a>`}return"No"};let Ge=({inFindColumn:t})=>{t.formatter=Ye};function Ye(t,e,a){return e.IsSettled?[`<a href="./ExitOrderItems.html?OrderNumber=${e.pk}" class="link-danger">`,'<i class="bi bi-dropbox"></i>',"</a>"].join(""):['<a href="#" class="link-danger DeleteClass">','<i class="bi bi-trash"></i>',"</a>"].join("")}let We=({inFindColumn:t})=>{t.formatter=Xe,t.footerFormatter=qe};function Xe(t,e,a){let l=localStorage.getItem("PresentOrder"),o=JSON.parse(l),n=e.ItemSerial,c=Object.values(o.AddOnData).filter(s=>s.AddOnItemSerial===n);return c.length>0?c.map(i=>i.AddOnRate).reduce((i,d)=>i+d,0)*e.Pcs+e.Total:e.Total}function qe(t){return this.field,"₹ "+t.map(function(e){return+e.Total}).reduce(function(e,a){return e+a},0)}let Qe=({inFindColumn:t})=>{t.formatter=Ze};const Ze=t=>{if(t===void 0)return"";var e=new Date-new Date(t),a=Math.floor(e/864e5),l=Math.floor(e%864e5/36e5),o=Math.round(e%864e5%36e5/6e4);return a+" days, "+l+" hours, "+o+" min..."};let _e=({inFindColumn:t})=>{t.footerFormatter=ta};function ta(t){var e=this.field;return t.map(function(l){return l[e]===void 0?0:+l[e]}).reduce(function(l,o){return l+o},0).toFixed(0)}let ea=({inFindColumn:t})=>{t.formatter=aa},aa=(t,e,a)=>new Date(t).toLocaleDateString("en-GB"),la=({inColumns:t})=>{let e=t,a=e.find(r=>r.field==="KS-Serial"),l=e.find(r=>r.field==="AggValues.SettlementAmount"),o=e.find(r=>r.field==="KS-AddOns"),n=e.find(r=>r.field==="Opts"),c=e.find(r=>r.field==="KS-Amount"),s=e.find(r=>r.field==="DateTime");e.find(r=>r.field==="ItemName");let i=e.find(r=>r.field==="Pcs");e.find(r=>r.field==="location");let d=e.find(r=>r.field==="DeliveryDateTime");e.find(r=>r.field==="ItemService"),a!==void 0&&He({inFindColumn:a}),l!==void 0&&xe({inFindColumn:l}),o!==void 0&&Ue({inFindColumn:o}),n!==void 0&&Ge({inFindColumn:n}),c!==void 0&&We({inFindColumn:c}),s!==void 0&&Qe({inFindColumn:s}),i!==void 0&&_e({inFindColumn:i}),d!==void 0&&ea({inFindColumn:d})};const oa=()=>{var t=$("#table");f.icons=be,f.onExpandRow=he,f.onClickRow=ke,la({inColumns:f.columns}),t.bootstrapTable(f)};let ra=(t,e,a)=>{let l=e.AddOnDataAsArray,n=document.getElementById("TemplateForAddOns").content.cloneNode("true");const s=new XMLSerializer().serializeToString(n);a.html(s).find("table").bootstrapTable({data:l})};const na="#toolbar",ca="pk",sa="true",ia=[],da=!0,ua="",ma="",fa="",La=[{field:"KS-Serial",title:"#"},{field:"ItemName",title:"ItemName"},{field:"Rate",title:"Rate"},{field:"Pcs",title:"Pcs"}],j={toolbar:na,idfield:ca,showFooter:sa,data:ia,detailView:da,onClickRow:ua,onExpandRow:ma,icons:fa,columns:La};let Ia=(t,e,a)=>{let l=e.AggValues.ItemsArray,n=document.getElementById("TemplateForItemNames").content.cloneNode("true");const s=new XMLSerializer().serializeToString(n);let i=a.html(s).find("table");j.data=l,j.onExpandRow=ra,i.bootstrapTable(j)};const Fa="bi-plus-circle fs-4",ja="bi-dash-circle fs-4",Va={detailOpen:Fa,detailClose:ja},Sa="#toolbar",pa="pk",$a="true",ha=[],ga=!0,Ca="",ba="",ya="",Oa=[{field:"pk",title:"Order#"},{field:"OrderData.Currentdateandtime",title:"Date",formatter:"LocalDate",visible:!1,class:"d-none d-sm-table-cell"},{field:"DateTime",title:"Time Span",formatter:"TimeDiff",class:"d-none d-sm-table-cell"},{field:"AggValues.ItemDetails",title:"Items",footerFormatter:"ItemsFormatter",class:"d-none d-sm-table-cell"},{field:"AggValues.SettlementAmount",title:"Settlement",footerFormatter:"priceFormatter",align:"right",class:"d-none d-sm-table-cell"},{field:"IsSettled",title:"IsSettled"},{title:"Opts.",field:"Opts",align:"center",formatter:""}],L={toolbar:Sa,idfield:pa,showFooter:$a,data:ha,detailView:ga,onClickRow:Ca,onExpandRow:ba,icons:ya,columns:Oa};let Da=({inFindColumn:t})=>{t.formatter=wa},wa=(t,e,a)=>a+1,Na=({inFindColumn:t})=>{t.footerFormatter=Ta,t.formatter=Aa};const Aa=(t,e,a)=>t===""?"":`₹ ${t}`;function Ta(t){return console.log("data : ",t),"₹ "+t.map(function(e){return+e.AggValues.SettlementAmount}).reduce(function(e,a){return e+a},0)}const Ba=({inFindColumn:t})=>{t.formatter=va},va=(t,e)=>{const a=e.AddOnArray;if(a&&a.length>0){const l=a.reduce((o,n)=>o+n.AddOnRate,0);return`<a href="#" class="btn btn-primary ">${a.length}-${l}</a>`}return"No"};let Ea=({inFindColumn:t})=>{t.formatter=Ra};function Ra(t,e,a){return[`<a href="./ExitOrderItems.html?OrderNumber=${e.pk}" class="link-danger">`,'<i class="bi bi-dropbox"></i>',"</a>"].join("")}let Ma=({inFindColumn:t})=>{t.formatter=ka,t.footerFormatter=Ha};function ka(t,e,a){let l=localStorage.getItem("PresentOrder"),o=JSON.parse(l),n=e.ItemSerial,c=Object.values(o.AddOnData).filter(s=>s.AddOnItemSerial===n);return c.length>0?c.map(i=>i.AddOnRate).reduce((i,d)=>i+d,0)*e.Pcs+e.Total:e.Total}function Ha(t){return this.field,"₹ "+t.map(function(e){return+e.Total}).reduce(function(e,a){return e+a},0)}let Pa=({inFindColumn:t})=>{t.formatter=xa};const xa=t=>{if(t===void 0)return"";var e=new Date-new Date(t),a=Math.floor(e/864e5),l=Math.floor(e%864e5/36e5),o=Math.round(e%864e5%36e5/6e4);return a+" days, "+l+" hours, "+o+" min..."};let Ja=({inFindColumn:t})=>{t.footerFormatter=Ka};function Ka(t){var e=this.field;return t.map(function(l){return l[e]===void 0?0:+l[e]}).reduce(function(l,o){return l+o},0).toFixed(0)}let Ua=({inFindColumn:t})=>{t.formatter=za},za=(t,e,a)=>new Date(t).toLocaleDateString("en-GB"),Ga=({inColumns:t})=>{let e=t,a=e.find(r=>r.field==="KS-Serial"),l=e.find(r=>r.field==="AggValues.SettlementAmount"),o=e.find(r=>r.field==="KS-AddOns"),n=e.find(r=>r.field==="Opts"),c=e.find(r=>r.field==="KS-Amount"),s=e.find(r=>r.field==="DateTime");e.find(r=>r.field==="ItemName");let i=e.find(r=>r.field==="Pcs");e.find(r=>r.field==="location");let d=e.find(r=>r.field==="DeliveryDateTime");e.find(r=>r.field==="ItemService"),a!==void 0&&Da({inFindColumn:a}),l!==void 0&&Na({inFindColumn:l}),o!==void 0&&Ba({inFindColumn:o}),n!==void 0&&Ea({inFindColumn:n}),c!==void 0&&Ma({inFindColumn:c}),s!==void 0&&Pa({inFindColumn:s}),i!==void 0&&Ja({inFindColumn:i}),d!==void 0&&Ua({inFindColumn:d})};const Ya="YesterdayTableId",Wa=()=>{var t=$(`#${Ya}`);L.icons=Va,L.onExpandRow=Ia,Ga({inColumns:L.columns}),t.bootstrapTable(L)};let Xa=(t,e,a)=>{let l=e.AddOnDataAsArray,n=document.getElementById("TemplateForAddOns").content.cloneNode("true");const s=new XMLSerializer().serializeToString(n);a.html(s).find("table").bootstrapTable({data:l})};const qa="#toolbar",Qa="pk",Za="true",_a=[],tl=!0,el="",al="",ll="",ol=[{field:"KS-Serial",title:"#"},{field:"ItemName",title:"ItemName"},{field:"Rate",title:"Rate"},{field:"Pcs",title:"Pcs"}],V={toolbar:qa,idfield:Qa,showFooter:Za,data:_a,detailView:tl,onClickRow:el,onExpandRow:al,icons:ll,columns:ol};let rl=(t,e,a)=>{let l=e.AggValues.ItemsArray,n=document.getElementById("TemplateForItemNames").content.cloneNode("true");const s=new XMLSerializer().serializeToString(n);let i=a.html(s).find("table");V.data=l,V.onExpandRow=Xa,i.bootstrapTable(V)};const nl="bi-plus-circle fs-4",cl="bi-dash-circle fs-4",sl={detailOpen:nl,detailClose:cl},il="#toolbar",dl="pk",ul="true",ml=[],fl=!0,Ll="",Il="",Fl="",jl=[{field:"pk",title:"Order#"},{field:"OrderData.Currentdateandtime",title:"Date",formatter:"LocalDate",visible:!1},{field:"DateTime",title:"Time Span",formatter:"TimeDiff",class:"d-none d-sm-table-cell"},{field:"AggValues.ItemDetails",title:"Items",footerFormatter:"ItemsFormatter",class:"d-none d-sm-table-cell"},{field:"AggValues.SettlementAmount",title:"Settlement",footerFormatter:"priceFormatter",align:"right",class:"d-none d-sm-table-cell"},{field:"IsSettled",title:"IsSettled"},{title:"Opts.",field:"Opts",align:"center",formatter:""}],I={toolbar:il,idfield:dl,showFooter:ul,data:ml,detailView:fl,onClickRow:Ll,onExpandRow:Il,icons:Fl,columns:jl};let Vl=({inFindColumn:t})=>{t.formatter=Sl},Sl=(t,e,a)=>a+1,pl=({inFindColumn:t})=>{t.footerFormatter=hl,t.formatter=$l};const $l=(t,e,a)=>t===""?"":`₹ ${t}`;function hl(t){return console.log("data : ",t),"₹ "+t.map(function(e){return+e.AggValues.SettlementAmount}).reduce(function(e,a){return e+a},0)}const gl=({inFindColumn:t})=>{t.formatter=Cl},Cl=(t,e)=>{const a=e.AddOnArray;if(a&&a.length>0){const l=a.reduce((o,n)=>o+n.AddOnRate,0);return`<a href="#" class="btn btn-primary ">${a.length}-${l}</a>`}return"No"};let bl=({inFindColumn:t})=>{t.formatter=yl};function yl(t,e,a){return[`<a href="./ExitOrderItems.html?OrderNumber=${e.pk}" class="link-danger">`,'<i class="bi bi-dropbox"></i>',"</a>"].join("")}let Ol=({inFindColumn:t})=>{t.formatter=Dl,t.footerFormatter=wl};function Dl(t,e,a){let l=localStorage.getItem("PresentOrder"),o=JSON.parse(l),n=e.ItemSerial,c=Object.values(o.AddOnData).filter(s=>s.AddOnItemSerial===n);return c.length>0?c.map(i=>i.AddOnRate).reduce((i,d)=>i+d,0)*e.Pcs+e.Total:e.Total}function wl(t){return this.field,"₹ "+t.map(function(e){return+e.Total}).reduce(function(e,a){return e+a},0)}let Nl=({inFindColumn:t})=>{t.formatter=Al};const Al=t=>{if(t===void 0)return"";var e=new Date-new Date(t),a=Math.floor(e/864e5),l=Math.floor(e%864e5/36e5),o=Math.round(e%864e5%36e5/6e4);return a+" days, "+l+" hours, "+o+" min..."};let Tl=({inFindColumn:t})=>{t.footerFormatter=Bl};function Bl(t){var e=this.field;return t.map(function(l){return l[e]===void 0?0:+l[e]}).reduce(function(l,o){return l+o},0).toFixed(0)}let vl=({inFindColumn:t})=>{t.formatter=El},El=(t,e,a)=>new Date(t).toLocaleDateString("en-GB"),Rl=({inColumns:t})=>{let e=t,a=e.find(r=>r.field==="KS-Serial"),l=e.find(r=>r.field==="AggValues.SettlementAmount"),o=e.find(r=>r.field==="KS-AddOns"),n=e.find(r=>r.field==="Opts"),c=e.find(r=>r.field==="KS-Amount"),s=e.find(r=>r.field==="DateTime");e.find(r=>r.field==="ItemName");let i=e.find(r=>r.field==="Pcs");e.find(r=>r.field==="location");let d=e.find(r=>r.field==="DeliveryDateTime");e.find(r=>r.field==="ItemService"),a!==void 0&&Vl({inFindColumn:a}),l!==void 0&&pl({inFindColumn:l}),o!==void 0&&gl({inFindColumn:o}),n!==void 0&&bl({inFindColumn:n}),c!==void 0&&Ol({inFindColumn:c}),s!==void 0&&Nl({inFindColumn:s}),i!==void 0&&Tl({inFindColumn:i}),d!==void 0&&vl({inFindColumn:d})};const Ml="ThisWeekTableId",kl=()=>{var t=$(`#${Ml}`);I.icons=sl,I.onExpandRow=rl,Rl({inColumns:I.columns}),t.bootstrapTable(I)},Hl=()=>{Wa(),kl()},Pl=()=>{Hl(),oa(),ie(),de(),xl()};let xl=()=>{if(Jl()!==""){var t=document.getElementById("CustomerNameSearchButtonId"),e=new Event("click");t.dispatchEvent(e)}},Jl=()=>{let e=document.getElementById("CustomerNameInputId");if(e!==null)return e.value.trim()};const Kl=async()=>{if(Pl(),D({inSuccessFunc:h})===!1)return await!1;h()};document.addEventListener("DOMContentLoaded",function(){let t=document.getElementById("editCustomerModal"),a=document.getElementById("CustomerNameInputId");t.addEventListener("shown.bs.modal",function(){document.getElementById("CustomerName").focus()}),t.addEventListener("hidden.bs.modal",()=>{setTimeout(()=>{a.setAttribute("tabindex","-1"),a.focus()},5)})});Kl().then();
