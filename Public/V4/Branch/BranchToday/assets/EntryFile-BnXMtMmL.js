const d=()=>i("KSToken")!=="",i=e=>document.cookie.split("; ").reduce((t,a)=>a.startsWith(e+"=")?a.split("=")[1]:t,""),u=()=>{const e=document.getElementById("LoginModalId");e.addEventListener("shown.bs.modal",function(){document.getElementById("UsernameId").focus()}),new bootstrap.Modal(e,{focus:!0}).show()};let m=()=>!(I()===!1||L()===!1);const I=()=>{let e=document.getElementById("UsernameId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},L=()=>{let e=document.getElementById("PasswordId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},g="POST",f={Accept:"application/json","Content-Type":"application/json"},y="",n={method:g,headers:f,body:y};let j=()=>{let e={},t=document.getElementById("UsernameId").value,a=document.getElementById("PasswordId").value;return e.UserName=t,e.Password=a,e},U=()=>(n.body=JSON.stringify(j()),n),h=async()=>{let e=U();return await await fetch("/Login/bin/Branch/UsingJwt/CreateToken",e)};const s=()=>{B(),V(),S()};let B=()=>{let t=document.getElementById("UserName"),a=localStorage.getItem("UserName");if(t!==null)return t.innerHTML=a},V=()=>{let t=document.getElementById("BranchLogOutId");const l=localStorage.getItem("BranchName").replace("BranOrders","");t!==null&&(t.innerHTML=l)},S=()=>{let t=document.getElementById("UserNameId"),a=localStorage.getItem("UserName");if(t!==null)return t.innerHTML=a},p=async({Status:e,inSuccessFunc:t})=>{let a=e;const l="BranchName";let c=localStorage.getItem("UserUuId");if(a.status===200){v(),s();const r=F("KSToken");if(r){const o=N(r);o&&(console.log(o),o.UserUuId!=c&&(localStorage.setItem(l,`BranOrders${o.Branch}`),localStorage.setItem("UserName",o.UserName),localStorage.setItem("UserUuId",o.UserUuId),window.location.href=""))}t()}a.status===401&&E()};const F=e=>{const a=`; ${document.cookie}`.split(`; ${e}=`);return a.length===2?a.pop().split(";").shift():null},N=e=>{try{const[t,a,l]=e.split(".");return JSON.parse(atob(a))}catch(t){return console.error("Error decoding JWT payload:",t),null}};let v=()=>{const e=document.getElementById("LoginModalId"),t=bootstrap.Modal.getInstance(e);t&&t.hide()},E=()=>{let e=document.getElementById("UsernameId"),t=document.getElementById("PasswordId");e.classList.add("is-invalid"),t.classList.add("is-invalid")},w=async({inSuccessFunc:e})=>{if(m()){let t=await h();p({Status:t,inSuccessFunc:e})}},k=({inSuccessFunc:e})=>{document.getElementById("LoginButtonId").addEventListener("click",async()=>{await w({inSuccessFunc:e})})},$=({inSuccessFunc:e})=>{k({inSuccessFunc:e})};const M=({inSuccessFunc:e})=>{if(d()===!0)return s(),!0;u(),$({inSuccessFunc:e})};export{M as S};
