import{S as C}from"./EntryFile-D68kwv0T.js";const h=()=>{let e=localStorage.getItem("CustomerNames");if(e===null){document.getElementById("MasterButtonId").click();return}let t=JSON.parse(e),o=document.getElementById("CustomersDataListId");t.forEach(a=>{let r=document.createElement("option");r.value=`${a.CustomerName}:${a.Mobile}`,r.innerHTML=`${a.CustomerName}:${a.Mobile}`,o.appendChild(r)})},V="POST",p={Accept:"application/json","Content-Type":"application/json"},y="",F={method:V,headers:p,body:y},g=()=>{let e=document.getElementById("CustomerNameInputId");console.log(e.value);let o=e.value.replace(/\D/g,""),a={};return a.FindKey="e.CustomerData.CustomerMobile",a.FindValue=o,a};let N=()=>(F.body=JSON.stringify(g()),F);const O="binV4",b="Masters",w="CustomerNames",D={OrderKey:"CustomerNames",ItemNamesKey:"ItemNames",AddOnsKey:"AddOns"},A={NewOrderButtonId:{PostFetch:"/Custom/Cleaning/Branch/Order/NewOrder",RedirectUrl:{"500Status":"/Laundry/Branch/NewOrders/HtmlFiles/AddItems.html","200Status":"AddItems.html"}},AddItemsButtonId:{PostFetch:"/Custom/Cleaning/Branch/Order/NewOrder",RedirectUrl:{"500Status":"/Laundry/Branch/NewOrders/HtmlFiles/AddItems.html","200Status":"AddItemsTotalRight.html"}}},c={routePath:O,folderName:b,tableName:w,localStorageKeys:D,Urls:A};let B=async()=>{let e=c.routePath,t=localStorage.getItem("BranchName"),o=N(),a=`/${e}/${t}/Show/FilterDataFromBody`;return await await fetch(a,o)},v=e=>{let o=e.JsonData.sort((l,s)=>l.pk===s.pk?0:l.pk<s.pk?1:-1),a=M({inData:o});var r=$("#table");r.bootstrapTable("load",a)},M=({inData:e})=>{let t=e,o=[];return o=t.map(a=>{a.AggValues={},a.AggValues.ItemDetails=`${Object.keys(a.ItemsInOrder).length} / ${Object.values(a.ItemsInOrder).map(l=>l.Pcs).reduce((l,s)=>l+parseInt(s),0)}`,a.AggValues.SettlementAmount="",Object.values(a.CheckOutData)[0]&&(a.AggValues.SettlementAmount=Object.values(a.CheckOutData)[0].CardAmount+Object.values(a.CheckOutData)[0].CashAmount+Object.values(a.CheckOutData)[0].UPIAmount,a.IsSettled=!1),Object.keys(a.CheckOutData).length>0&&(a.IsSettled=!0);let r=Object.values(a.AddOnData);return a.AggValues.ItemsArray=Object.values(a.ItemsInOrder).map(l=>(l.AddOnDataAsArray=r.filter(s=>s.AddOnItemSerial===l.ItemSerial),l)),a}),o},T=async()=>{let e=await B();e.status===200&&v(await e.json())};const S=()=>{T()};let E=()=>{document.getElementById("CustomerNameInputId").addEventListener("keypress",o=>{o.key==="Enter"&&S()})},k=async()=>{let e=document.getElementById("CustomerNameInputId");if(e.value==="")return e.classList.add("is-invalid"),!1;let t=await H();return console.log("LocalFech:",t),t===!1?(e.classList.add("is-invalid"),!1):!0};const H=async()=>{let t=document.getElementById("CustomerNameInputId").value.split(":")[1],o=`/${c.routePath}/MastersCustomers/Show/Filter/Mobile/${t}`;return(await fetch(o)).status!==500},P="POST",R={Accept:"application/json","Content-Type":"application/json"},K={ItemsInOrder:{},CustomerData:{CustomerName:"",CustomerMobile:""},OrderData:{BranchName:"",Currentdateandtime:""},AddOnData:{},CheckOutData:{}},i={method:P,headers:R,body:K};let U=()=>{let e=J(),t=e.split(":")[1],o=e.split(":")[0],a=localStorage.getItem("BranchName");return i.body.CustomerData.CustomerMobile=t,i.body.CustomerData.CustomerName=o,i.body.OrderData.BranchName=a,i.body.OrderData.Currentdateandtime=x(),i.body=JSON.stringify(i.body),i},J=()=>{let t=document.getElementById("CustomerNameInputId");if(t!==null)return t.value.trim()},x=()=>{let e=new Date,t=new Date(e),o=(t.getSeconds()<10?"0":"")+t.getSeconds(),a=(t.getMinutes()<10?"0":"")+t.getMinutes(),r=(t.getHours()<10?"0":"")+t.getHours(),l=(t.getDate()<10?"0":"")+t.getDate(),s=(t.getMonth()+1<10?"0":"")+(t.getMonth()+1);return`${t.getFullYear()}-${s}-${l} ${r}:${a}:${o}`},z=async()=>{let e=U(),t=localStorage.getItem("BranchName"),o=`${c.Urls.NewOrderButtonId.PostFetch}/${t}`;return await await fetch(o,e)},G=()=>{window.location=c.Urls.NewOrderButtonId.RedirectUrl["200Status"]},q=({inresponse:e})=>{Swal.fire({title:"Error Alert",text:`${e}`,icon:"error",confirmButtonColor:"#3085d6",showDenyButton:!0,denyButtonText:"Add ItemsV1",denyButtonColor:"#008000"}).then(t=>{(t.isConfirmed||t.isDismissed)&&(window.location.href=""),t.isDenied&&(window.location.href=c.Urls.NewOrderButtonId.RedirectUrl["500Status"])})},X=async()=>{let e=await z();e.status===200&&G(await e.json()),e.status===500&&q({inresponse:await e.text()})};const Y=async()=>{await k()&&X()};let Q=()=>{document.getElementById("NewOrderButtonId").addEventListener("click",Y)},W=()=>{document.getElementById("CustomerNameSearchButtonId").addEventListener("click",S)},Z=async()=>{let e=c.routePath,t=c.localStorageKeys.OrderKey,o=`/${e}/MastersCustomers/Show/DataOnly`,r=await(await fetch(o)).json();localStorage.setItem(t,JSON.stringify(r))},_=async()=>{let e=c.routePath,t=c.localStorageKeys.ItemNamesKey,o=`/${e}/MastersItems/Show/DataOnly`,r=await(await fetch(o)).json();localStorage.setItem(t,JSON.stringify(r))},tt=async()=>{let e=c.routePath,t=c.localStorageKeys.AddOnsKey,o=`/${e}/MastersAddOns/Show/DataOnly`,r=await(await fetch(o)).json();localStorage.setItem(t,JSON.stringify(r))},et=()=>{Z().then(()=>{at()}),_().then(),tt().then(()=>location.reload())};const at=()=>{let e=localStorage.getItem("CustomerNames");if(e!==null){let t=JSON.parse(e),o=document.getElementById("CustomersDataListId");o.innerHTML="",t.forEach(a=>{let r=document.createElement("option");r.value=`${a.CustomerName}:${a.Mobile}`,r.innerHTML=`${a.CustomerName}:${a.Mobile}`,o.appendChild(r)})}};let ot=()=>{document.getElementById("MasterButtonId").addEventListener("click",()=>{et()})},rt=()=>{let e=localStorage.getItem("BranchName"),t=document.getElementById("BranchButtonId");t.innerText=e,t.addEventListener("click",function(){window.location.href="/LoginUsers/HtmlFiles/login.html"})},lt=async()=>{let e=document.getElementById("CustomerNameInputId");if(e.value==="")return e.classList.add("is-invalid"),!1;let t=await nt();return console.log("LocalFech:",t),t===!1?(e.classList.add("is-invalid"),!1):!0};const nt=async()=>{let t=document.getElementById("CustomerNameInputId").value.split(":")[1],o=`/${c.routePath}/MastersCustomers/Show/Filter/Mobile/${t}`;return(await fetch(o)).status!==500},st="POST",ct={Accept:"application/json","Content-Type":"application/json"},dt={ItemsInOrder:{},CustomerData:{CustomerName:"",CustomerMobile:""},OrderData:{BranchName:"",Currentdateandtime:""},AddOnData:{},CheckOutData:{}},m={method:st,headers:ct,body:dt};let ut=()=>{let e=it(),t=e.split(":")[1],o=e.split(":")[0],a=localStorage.getItem("BranchName");return m.body.CustomerData.CustomerMobile=t,m.body.CustomerData.CustomerName=o,m.body.OrderData.BranchName=a,m.body.OrderData.Currentdateandtime=mt(),m.body=JSON.stringify(m.body),m},it=()=>{let t=document.getElementById("CustomerNameInputId");if(t!==null)return t.value.trim()},mt=()=>{let e=new Date,t=new Date(e),o=(t.getSeconds()<10?"0":"")+t.getSeconds(),a=(t.getMinutes()<10?"0":"")+t.getMinutes(),r=(t.getHours()<10?"0":"")+t.getHours(),l=(t.getDate()<10?"0":"")+t.getDate(),s=(t.getMonth()+1<10?"0":"")+(t.getMonth()+1);return`${t.getFullYear()}-${s}-${l} ${r}:${a}:${o}`},ft=async()=>{let e=ut(),t=localStorage.getItem("BranchName"),o=`${c.Urls.AddItemsButtonId.PostFetch}/${t}`;return await await fetch(o,e)},It=()=>{const e=document.getElementById("AddItemsHtmlId").value;e==="AddRight"?window.location.href="./AddItemsTotalRight.html":e==="AddBottom"&&(window.location.href="./AddItemsButtom.html")},Lt=({inresponse:e})=>{Swal.fire({title:"Error Alert",text:`${e}`,icon:"error",confirmButtonColor:"#3085d6",showDenyButton:!0,denyButtonText:"Add ItemsV1",denyButtonColor:"#008000"}).then(t=>{(t.isConfirmed||t.isDismissed)&&(window.location.href=""),t.isDenied&&(window.location.href=c.Urls.NewOrderButtonId.RedirectUrl["500Status"])})},ht=async()=>{let e=await ft();e.status===200&&It(await e.json()),e.status===500&&Lt({inresponse:await e.text()})};const Ft=async()=>{await lt()&&ht()};let jt=()=>{document.getElementById("AddItemsButtonId").addEventListener("click",Ft)},St=()=>{E(),Q(),W(),ot(),rt(),jt()};const Ct=()=>{let e=j({inGetKey:"CustomerMobile"}),t=j({inGetKey:"CustomerName"});if(e!==null&&t!==null){let o=`${e}:${t}`;Vt(o)}};let Vt=e=>{let o=document.getElementById("CustomerNameInputId");o!==null&&(o.value=e)},j=({inGetKey:e})=>{const t=window.location.search;return new URLSearchParams(t).get(e)},pt=(e,t,o)=>{let a=t.AddOnDataAsArray,l=document.getElementById("TemplateForAddOns").content.cloneNode("true");const d=new XMLSerializer().serializeToString(l);o.html(d).find("table").bootstrapTable({data:a})};const yt="#toolbar",gt="pk",$t="true",Nt=[],Ot=!0,bt="",wt="",Dt="",At=[{field:"KS-Serial",title:"#"},{field:"ItemName",title:"ItemName"},{field:"Rate",title:"Rate"},{field:"Pcs",title:"Pcs"}],L={toolbar:yt,idfield:gt,showFooter:$t,data:Nt,detailView:Ot,onClickRow:bt,onExpandRow:wt,icons:Dt,columns:At};let Bt=(e,t,o)=>{let a=t.AggValues.ItemsArray,l=document.getElementById("TemplateForItemNames").content.cloneNode("true");const d=new XMLSerializer().serializeToString(l);let u=o.html(d).find("table");L.data=a,L.onExpandRow=pt,u.bootstrapTable(L)};const vt="bi-plus-circle fs-4",Mt="bi-dash-circle fs-4",Tt={detailOpen:vt,detailClose:Mt},Et="#toolbar",kt="pk",Ht="true",Pt=[],Rt=!0,Kt="",Ut="",Jt="",xt=[{field:"pk",title:"Order#"},{field:"OrderData.Currentdateandtime",title:"Date",formatter:"LocalDate",visible:!1},{field:"DateTime",title:"Time Span",formatter:"TimeDiff"},{field:"AggValues.ItemDetails",title:"Items",footerFormatter:"ItemsFormatter"},{field:"AggValues.SettlementAmount",title:"Settlement",footerFormatter:"priceFormatter",align:"right"},{field:"IsSettled",title:"IsSettled"},{title:"Opts.",field:"Opts",formatter:""}],I={toolbar:Et,idfield:kt,showFooter:Ht,data:Pt,detailView:Rt,onClickRow:Kt,onExpandRow:Ut,icons:Jt,columns:xt};let zt=({inFindColumn:e})=>{e.formatter=Gt},Gt=(e,t,o)=>o+1,qt=({inFindColumn:e})=>{e.footerFormatter=Yt,e.formatter=Xt};const Xt=(e,t,o)=>e===""?"":`₹ ${e}`;function Yt(e){return console.log("data : ",e),"₹ "+e.map(function(t){return+t.AggValues.SettlementAmount}).reduce(function(t,o){return t+o},0)}const Qt=({inFindColumn:e})=>{e.formatter=Wt},Wt=(e,t)=>{const o=t.AddOnArray;if(o&&o.length>0){const a=o.reduce((r,l)=>r+l.AddOnRate,0);return`<a href="#" class="btn btn-primary ">${o.length}-${a}</a>`}return"No"};let Zt=({inFindColumn:e})=>{e.formatter=_t};function _t(e,t,o){return['<a href="#" class="link-danger">','<i class="bi bi-trash3"></i>',"</a>"].join("")}let te=({inFindColumn:e})=>{e.formatter=ee,e.footerFormatter=ae};function ee(e,t,o){let a=localStorage.getItem("PresentOrder"),r=JSON.parse(a),l=t.ItemSerial,s=Object.values(r.AddOnData).filter(d=>d.AddOnItemSerial===l);return s.length>0?s.map(u=>u.AddOnRate).reduce((u,f)=>u+f,0)*t.Pcs+t.Total:t.Total}function ae(e){return this.field,"₹ "+e.map(function(t){return+t.Total}).reduce(function(t,o){return t+o},0)}let oe=({inFindColumn:e})=>{e.formatter=re};const re=e=>{if(e===void 0)return"";var t=new Date-new Date(e),o=Math.floor(t/864e5),a=Math.floor(t%864e5/36e5),r=Math.round(t%864e5%36e5/6e4);return o+" days, "+a+" hours, "+r+" min..."};let le=({inFindColumn:e})=>{e.footerFormatter=ne};function ne(e){var t=this.field;return e.map(function(a){return a[t]===void 0?0:+a[t]}).reduce(function(a,r){return a+r},0).toFixed(0)}let se=({inFindColumn:e})=>{e.formatter=ce},ce=(e,t,o)=>new Date(e).toLocaleDateString("en-GB"),de=({inColumns:e})=>{let t=e,o=t.find(n=>n.field==="KS-Serial"),a=t.find(n=>n.field==="AggValues.SettlementAmount"),r=t.find(n=>n.field==="KS-AddOns"),l=t.find(n=>n.field==="KS-Opts"),s=t.find(n=>n.field==="KS-Amount"),d=t.find(n=>n.field==="DateTime");t.find(n=>n.field==="ItemName");let u=t.find(n=>n.field==="Pcs");t.find(n=>n.field==="location");let f=t.find(n=>n.field==="DeliveryDateTime");t.find(n=>n.field==="ItemService"),o!==void 0&&zt({inFindColumn:o}),a!==void 0&&qt({inFindColumn:a}),r!==void 0&&Qt({inFindColumn:r}),l!==void 0&&Zt({inFindColumn:l}),s!==void 0&&te({inFindColumn:s}),d!==void 0&&oe({inFindColumn:d}),u!==void 0&&le({inFindColumn:u}),f!==void 0&&se({inFindColumn:f})};const ue=()=>{var e=$("#table");I.icons=Tt,I.onExpandRow=Bt,de({inColumns:I.columns}),e.bootstrapTable(I)},ie=()=>{ue(),St(),Ct(),me()};let me=()=>{if(fe()!==""){var e=document.getElementById("CustomerNameSearchButtonId"),t=new Event("click");e.dispatchEvent(t)}},fe=()=>{let t=document.getElementById("CustomerNameInputId");if(t!==null)return t.value.trim()};const Ie=async()=>{if(ie(),C({inSuccessFunc:h})===!1)return await!1;h()};Ie().then();
