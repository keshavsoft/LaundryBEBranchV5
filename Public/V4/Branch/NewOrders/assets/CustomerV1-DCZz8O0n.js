import{S as y}from"./EntryFile-D68kwv0T.js";const L=()=>{let e=localStorage.getItem("CustomerNames");if(e===null){document.getElementById("MasterButtonId").click();return}let t=JSON.parse(e),o=document.getElementById("CustomersDataListId");t.forEach(a=>{let r=document.createElement("option");r.value=`${a.CustomerName}:${a.Mobile}`,r.innerHTML=`${a.CustomerName}:${a.Mobile}`,o.appendChild(r)})},V="POST",C={Accept:"application/json","Content-Type":"application/json"},F="",h={method:V,headers:C,body:F},f=()=>{let e=document.getElementById("CustomerNameInputId");console.log(e.value);let o=e.value.replace(/\D/g,""),a={};return a.FindKey="e.CustomerData.CustomerMobile",a.FindValue=o,a};let g=()=>(h.body=JSON.stringify(f()),h);const S="binV4",N="Masters",b="CustomerNames",w={OrderKey:"CustomerNames",ItemNamesKey:"ItemNames",AddOnsKey:"AddOns"},O={NewOrderButtonId:{PostFetch:"/Custom/Cleaning/Branch/Order/NewOrder",RedirectUrl:{"500Status":"/Laundry/Branch/NewOrders/HtmlFiles/AddItems.html","200Status":"AddItems.html"}},AddItemsButtonId:{PostFetch:"/Custom/Cleaning/Branch/Order/NewOrder",RedirectUrl:{"500Status":"/Laundry/Branch/NewOrders/HtmlFiles/AddItems.html","200Status":"AddItemsTotalRight.html"}}},n={routePath:S,folderName:N,tableName:b,localStorageKeys:w,Urls:O};let D=async()=>{let e=n.routePath,t=localStorage.getItem("BranchName"),o=g(),a=`/${e}/${t}/Show/FilterDataFromBody`;return await await fetch(a,o)},B=e=>{let o=e.JsonData.sort((l,s)=>l.pk===s.pk?0:l.pk<s.pk?1:-1),a=A({inData:o});var r=$("#table");r.bootstrapTable("load",a)},A=({inData:e})=>{let t=e,o=[];return o=t.map(a=>{a.AggValues={},a.AggValues.ItemDetails=`${Object.keys(a.ItemsInOrder).length} / ${Object.values(a.ItemsInOrder).map(l=>l.Pcs).reduce((l,s)=>l+parseInt(s),0)}`,a.AggValues.SettlementAmount="",Object.values(a.CheckOutData)[0]&&(a.AggValues.SettlementAmount=Object.values(a.CheckOutData)[0].CardAmount+Object.values(a.CheckOutData)[0].CashAmount+Object.values(a.CheckOutData)[0].UPIAmount,a.IsSettled=!1),Object.keys(a.CheckOutData).length>0&&(a.IsSettled=!0);let r=Object.values(a.AddOnData);return a.AggValues.ItemsArray=Object.values(a.ItemsInOrder).map(l=>(l.AddOnDataAsArray=r.filter(s=>s.AddOnItemSerial===l.ItemSerial),l)),a}),o},v=async()=>{let e=await D();e.status===200&&B(await e.json())};const p=()=>{v()};let M=()=>{document.getElementById("CustomerNameInputId").addEventListener("keypress",o=>{o.key==="Enter"&&p()})},E=async()=>{let e=document.getElementById("CustomerNameInputId");if(e.value==="")return e.classList.add("is-invalid"),!1;let t=await T();return console.log("LocalFech:",t),t===!1?(e.classList.add("is-invalid"),!1):!0};const T=async()=>{let t=document.getElementById("CustomerNameInputId").value.split(":")[1],o=`/${n.routePath}/MastersCustomers/Show/Filter/Mobile/${t}`;return(await fetch(o)).status!==500},k="POST",H={Accept:"application/json","Content-Type":"application/json"},R={ItemsInOrder:{},CustomerData:{CustomerName:"",CustomerMobile:""},OrderData:{BranchName:"",Currentdateandtime:""},AddOnData:{},CheckOutData:{}},c={method:k,headers:H,body:R};let U=()=>{let e=P(),t=e.split(":")[1],o=e.split(":")[0],a=localStorage.getItem("BranchName");return c.body.CustomerData.CustomerMobile=t,c.body.CustomerData.CustomerName=o,c.body.OrderData.BranchName=a,c.body.OrderData.Currentdateandtime=K(),c.body=JSON.stringify(c.body),c},P=()=>{let t=document.getElementById("CustomerNameInputId");if(t!==null)return t.value.trim()},K=()=>{let e=new Date,t=new Date(e),o=(t.getSeconds()<10?"0":"")+t.getSeconds(),a=(t.getMinutes()<10?"0":"")+t.getMinutes(),r=(t.getHours()<10?"0":"")+t.getHours(),l=(t.getDate()<10?"0":"")+t.getDate(),s=(t.getMonth()+1<10?"0":"")+(t.getMonth()+1);return`${t.getFullYear()}-${s}-${l} ${r}:${a}:${o}`},J=async()=>{let e=U(),t=localStorage.getItem("BranchName"),o=`${n.Urls.NewOrderButtonId.PostFetch}/${t}`;return await await fetch(o,e)},x=()=>{window.location=n.Urls.NewOrderButtonId.RedirectUrl["200Status"]},z=({inresponse:e})=>{Swal.fire({title:"Error Alert",text:`${e}`,icon:"error",confirmButtonColor:"#3085d6",showDenyButton:!0,denyButtonText:"Add ItemsV1",denyButtonColor:"#008000"}).then(t=>{(t.isConfirmed||t.isDismissed)&&(window.location.href=""),t.isDenied&&(window.location.href=n.Urls.NewOrderButtonId.RedirectUrl["500Status"])})},q=async()=>{let e=await J();e.status===200&&x(await e.json()),e.status===500&&z({inresponse:await e.text()})};const G=async()=>{await E()&&q()};let X=()=>{document.getElementById("NewOrderButtonId").addEventListener("click",G)},Y=()=>{document.getElementById("CustomerNameSearchButtonId").addEventListener("click",p)},Q=async()=>{let e=n.routePath,t=n.localStorageKeys.OrderKey,o=`/${e}/MastersCustomers/Show/DataOnly`,r=await(await fetch(o)).json();localStorage.setItem(t,JSON.stringify(r))},W=async()=>{let e=n.routePath,t=n.localStorageKeys.ItemNamesKey,o=`/${e}/MastersItems/Show/DataOnly`,r=await(await fetch(o)).json();localStorage.setItem(t,JSON.stringify(r))},Z=async()=>{let e=n.routePath,t=n.localStorageKeys.AddOnsKey,o=`/${e}/MastersAddOns/Show/DataOnly`,r=await(await fetch(o)).json();localStorage.setItem(t,JSON.stringify(r))},_=()=>{Q().then(()=>{tt()}),W().then(),Z().then(()=>location.reload())};const tt=()=>{let e=localStorage.getItem("CustomerNames");if(e!==null){let t=JSON.parse(e),o=document.getElementById("CustomersDataListId");o.innerHTML="",t.forEach(a=>{let r=document.createElement("option");r.value=`${a.CustomerName}:${a.Mobile}`,r.innerHTML=`${a.CustomerName}:${a.Mobile}`,o.appendChild(r)})}};let et=()=>{document.getElementById("MasterButtonId").addEventListener("click",()=>{_()})},at=()=>{let e=localStorage.getItem("BranchName"),t=document.getElementById("BranchButtonId");t.innerText=e,t.addEventListener("click",function(){window.location.href="/LoginUsers/HtmlFiles/login.html"})},ot=async()=>{let e=document.getElementById("CustomerNameInputId");if(e.value==="")return e.classList.add("is-invalid"),!1;let t=await rt();return console.log("LocalFech:",t),t===!1?(e.classList.add("is-invalid"),!1):!0};const rt=async()=>{let t=document.getElementById("CustomerNameInputId").value.split(":")[1],o=`/${n.routePath}/MastersCustomers/Show/Filter/Mobile/${t}`;return(await fetch(o)).status!==500},lt="POST",nt={Accept:"application/json","Content-Type":"application/json"},st={ItemsInOrder:{},CustomerData:{CustomerName:"",CustomerMobile:""},OrderData:{BranchName:"",Currentdateandtime:""},AddOnData:{},CheckOutData:{}},d={method:lt,headers:nt,body:st};let ct=()=>{let e=dt(),t=e.split(":")[1],o=e.split(":")[0],a=localStorage.getItem("BranchName");return d.body.CustomerData.CustomerMobile=t,d.body.CustomerData.CustomerName=o,d.body.OrderData.BranchName=a,d.body.OrderData.Currentdateandtime=ut(),d.body=JSON.stringify(d.body),d},dt=()=>{let t=document.getElementById("CustomerNameInputId");if(t!==null)return t.value.trim()},ut=()=>{let e=new Date,t=new Date(e),o=(t.getSeconds()<10?"0":"")+t.getSeconds(),a=(t.getMinutes()<10?"0":"")+t.getMinutes(),r=(t.getHours()<10?"0":"")+t.getHours(),l=(t.getDate()<10?"0":"")+t.getDate(),s=(t.getMonth()+1<10?"0":"")+(t.getMonth()+1);return`${t.getFullYear()}-${s}-${l} ${r}:${a}:${o}`},mt=async()=>{let e=ct(),t=localStorage.getItem("BranchName"),o=`${n.Urls.AddItemsButtonId.PostFetch}/${t}`;return await await fetch(o,e)},it=()=>{const e=document.getElementById("AddItemsHtmlId").value;e==="AddRight"?window.location.href="./AddItemsTotalRight.html":e==="AddBottom"&&(window.location.href="./AddItemsButtom.html")},It=({inresponse:e})=>{Swal.fire({title:"Error Alert",text:`${e}`,icon:"error",confirmButtonColor:"#3085d6",showDenyButton:!0,denyButtonText:"Add ItemsV1",denyButtonColor:"#008000"}).then(t=>{(t.isConfirmed||t.isDismissed)&&(window.location.href=""),t.isDenied&&(window.location.href=n.Urls.NewOrderButtonId.RedirectUrl["500Status"])})},Lt=async()=>{let e=await mt();e.status===200&&it(await e.json()),e.status===500&&It({inresponse:await e.text()})};const ht=async()=>{await ot()&&Lt()};let jt=()=>{document.getElementById("AddItemsButtonId").addEventListener("click",ht)},pt=()=>{M(),X(),Y(),et(),at(),jt()};const yt=()=>{let e=j({inGetKey:"CustomerMobile"}),t=j({inGetKey:"CustomerName"});if(e!==null&&t!==null){let o=`${e}:${t}`;Vt(o)}};let Vt=e=>{let o=document.getElementById("CustomerNameInputId");o!==null&&(o.value=e)},j=({inGetKey:e})=>{const t=window.location.search;return new URLSearchParams(t).get(e)},Ct=(e,t,o)=>{let a=t.AddOnDataAsArray,l=document.getElementById("TemplateForAddOns").content.cloneNode("true");const u=new XMLSerializer().serializeToString(l);o.html(u).find("table").bootstrapTable({data:a})};const Ft="#toolbar",ft="pk",gt="true",St=[],$t=!0,Nt="",bt="",wt="",Ot=[{field:"KS-Serial",title:"#"},{field:"ItemName",title:"ItemName"},{field:"Rate",title:"Rate"},{field:"Pcs",title:"Pcs"}],i={toolbar:Ft,idfield:ft,showFooter:gt,data:St,detailView:$t,onClickRow:Nt,onExpandRow:bt,icons:wt,columns:Ot};let Dt=(e,t,o)=>{let a=t.AggValues.ItemsArray,l=document.getElementById("TemplateForItemNames").content.cloneNode("true");const u=new XMLSerializer().serializeToString(l);let I=o.html(u).find("table");i.data=a,i.onExpandRow=Ct,I.bootstrapTable(i)};const Bt="bi-plus-circle fs-4",At="bi-dash-circle fs-4",vt={detailOpen:Bt,detailClose:At},Mt="#toolbar",Et="pk",Tt="true",kt=[],Ht=!0,Rt="",Ut="",Pt="",Kt=[{field:"pk",title:"Order#"},{field:"OrderData.Currentdateandtime",title:"Date",formatter:"LocalDate",visible:!1},{field:"DateTime",title:"Time Span",formatter:"TimeDiff"},{field:"AggValues.ItemDetails",title:"Items",footerFormatter:"ItemsFormatter"},{field:"AggValues.SettlementAmount",title:"Settlement",footerFormatter:"priceFormatter"},{field:"IsSettled",title:"IsSettled"},{title:"Opts.",field:"Opts",formatter:""}],m={toolbar:Mt,idfield:Et,showFooter:Tt,data:kt,detailView:Ht,onClickRow:Rt,onExpandRow:Ut,icons:Pt,columns:Kt};let Jt=({inFindColumn:e})=>{e.formatter=xt};function xt(e,t,o){return console.log("row:",t),[`<a href="../HtmlFiles/ExitOrderItems.html?OrderNumber=${t.pk}" class="btn btn-primary btn-circle">`,'<i class="bi bi-door-open"></i>',"</a>"].join("")}let zt=({inColumns:e})=>{let o=e.find(a=>a.field==="Opts");o!==void 0&&Jt({inFindColumn:o})};const qt=()=>{var e=$("#table");m.icons=vt,m.onExpandRow=Dt,zt({inColumns:m.columns}),e.bootstrapTable(m)},Gt=()=>{qt(),pt(),yt(),Xt()};let Xt=()=>{if(Yt()!==""){var e=document.getElementById("CustomerNameSearchButtonId"),t=new Event("click");e.dispatchEvent(t)}},Yt=()=>{let t=document.getElementById("CustomerNameInputId");if(t!==null)return t.value.trim()};const Qt=async()=>{if(Gt(),y({inSuccessFunc:L})===!1)return await!1;L()};Qt().then();
