var b=Object.defineProperty,p=Object.defineProperties;var h=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var j=(e,t,a)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,I=(e,t)=>{for(var a in t||(t={}))T.call(t,a)&&j(e,a,t[a]);if(F)for(var a of F(t))C.call(t,a)&&j(e,a,t[a]);return e},L=(e,t)=>p(e,h(t));import{S as w}from"./EntryFile-D68kwv0T.js";/* empty css              */let v=()=>{N()},N=()=>{const e=new URL(window.location.href),t=new URL("./Customer.html",e);let a=D(),l=K();t.searchParams.append("CustomerMobile",a),t.searchParams.append("CustomerName",l),window.location.href=t.href},D=()=>{let t=document.getElementById("CustomerMobileId");if(t!==null)return t.value.trim()},K=()=>{let t=document.getElementById("CustomerNameId");if(t!==null)return t.value.trim()},B=()=>{let e=document.getElementById("BranchNameAnchorId");e!==null&&e.addEventListener("click",v)};const R=()=>{var e=$("#table").bootstrapTable("getData");return e.length===0?(window.alert("Please Add Items"),!1):!0};let M=()=>{R()&&E()},E=()=>{const e=new URL(window.location.href),t=new URL("./Settlement.html",e);let a=H();t.searchParams.append("OrderNumber",a),window.location.href=t.href},H=()=>{let t=document.getElementById("OrderNumberId");if(t!==null)return t.innerHTML.trim()},P=()=>{let e=document.getElementById("CheckOutButtonId");e!==null&&e.addEventListener("click",M)},J=()=>{B(),P()},k=()=>{J(),U()},U=()=>{var e=new Event("change");document.getElementById("TableFooterCategoryId")!==null&&document.getElementById("TableFooterCategoryId").dispatchEvent(e)};const x="binV4",_="Transactions",G="Kakinada",q={OrderKey:"PresentOrder",ItemNamesKey:"ItemNames",AddOnsKey:"AddOns",PresentOrderAddOnsKey:"PresentOrderAddOns"},W={ItemsTable:{DeleteUrl_Common:"$tableName/SubTable/Delete/SubKey/:Id/:inKey/:SubId",DeleteAddOnUrl:"/Custom/Cleaning/Branch/Order/NewOrder/addOn/$tableName/:Id/:SubId/:AddOnKey",DeleteItemUrl:"/Custom/Cleaning/Branch/Order/NewOrder/Item/$tableName/:Id/:SubId"}},z={AddOnModal:"AddOnModal"},i={routePath:x,folderName:_,tableName:G,localStorageKeys:q,ApiUrls:W,ModalIds:z};let V=async()=>{let e=localStorage.getItem("BranchName"),t=i.localStorageKeys.OrderKey,l=`/Custom/Cleaning/Branch/Order/NewOrder/RowData/${Q({inGetKey:"OrderNumber"})}/${e}`,c=await(await fetch(l)).json();localStorage.setItem(t,JSON.stringify(c))},Q=({inGetKey:e})=>{const t=window.location.search;return new URLSearchParams(t).get(e)},X=async()=>{await V()},Y=({inRow:e})=>{const t=e;Z(t.ItemName),ee(t.pk),te(t.Rate)},Z=e=>{let a=document.getElementById("AddOnModalItemNameId");a!==null&&(a.value=e)},ee=e=>{let a=document.getElementById("AddOnModalItemSerialId");a!==null&&(a.value=e)},te=e=>{let a=document.getElementById("exampleFormControlInput1");a!==null&&(a.value=e)};const ae=({inRow:e})=>{if(e.AddOnArray.length===0)return;let t=e.AddOnArray;const a=i.ModalIds.AddOnModal;var l=$("#AddOnTable");l.bootstrapTable("load",t),Y({inRow:e}),$(`#${a}`).modal("show")},le=(e,t,a)=>{a==="KS-AddOns"&&ae({inRow:e})};let oe=()=>{},re=({inFindColumn:e})=>{e.formatter=ne},ne=(e,t,a)=>a+1,de=({inFindColumn:e})=>{e.footerFormatter=ce};function ce(e){return this.field,"₹ "+e.map(function(t){return+t.Rate}).reduce(function(t,a){return t+a},0)}const ie=({inFindColumn:e})=>{e.formatter=me},me=(e,t)=>{const a=t.AddOnArray;if(a&&a.length>0){const l=a.reduce((o,c)=>o+c.AddOnRate,0);return`<a href="#" class="btn btn-primary ">${a.length}-${l}</a>`}return"No"};let se=({inFindColumn:e})=>{e.formatter=ue};function ue(e,t,a){return['<a href="#" class="link-danger">','<i class="bi bi-trash3"></i>',"</a>"].join("")}let Ie=({inFindColumn:e})=>{e.formatter=Le,e.footerFormatter=Se};function Le(e,t,a){let l=localStorage.getItem("PresentOrder"),o=JSON.parse(l),c=t.ItemSerial,n=Object.values(o.AddOnData).filter(d=>d.AddOnItemSerial===c);return n.length>0?n.map(m=>m.AddOnRate).reduce((m,u)=>m+u,0)*t.Pcs+t.Total:t.Total}function Se(e){return this.field,"₹ "+e.map(function(t){return+t.Total}).reduce(function(t,a){return t+a},0)}let fe=({inFindColumn:e})=>{e.footerFormatter=""},Fe=({inFindColumn:e})=>{e.footerFormatter=je};function je(e){var t=this.field;return e.map(function(l){return l[t]===void 0?0:+l[t]}).reduce(function(l,o){return l+o},0).toFixed(0)}let Oe=({inFindColumn:e})=>{e.formatter=Ve},Ve=(e,t,a)=>new Date(e).toLocaleDateString("en-GB"),Ae=({inColumns:e})=>{let t=e,a=t.find(r=>r.field==="KS-Serial"),l=t.find(r=>r.field==="Rate"),o=t.find(r=>r.field==="KS-AddOns"),c=t.find(r=>r.field==="KS-Opts"),n=t.find(r=>r.field==="KS-Amount"),d=t.find(r=>r.field==="Category");t.find(r=>r.field==="ItemName");let m=t.find(r=>r.field==="Pcs");t.find(r=>r.field==="location");let u=t.find(r=>r.field==="DeliveryDateTime");t.find(r=>r.field==="ItemService"),a!==void 0&&re({inFindColumn:a}),l!==void 0&&de({inFindColumn:l}),o!==void 0&&ie({inFindColumn:o}),c!==void 0&&se({inFindColumn:c}),n!==void 0&&Ie({inFindColumn:n}),d!==void 0&&fe({inFindColumn:d}),m!==void 0&&Fe({inFindColumn:m}),u!==void 0&&Oe({inFindColumn:u})};const ge=(e,t)=>e.ItemService==="PW"?{classes:"table-warning"}:{},ye=[],be="true",pe=[{field:"KS-Serial",title:"#",width:5,widthUnit:"%"},{field:"Category",title:"Category",width:10,widthUnit:"%",visible:!1},{field:"ItemName",title:"Item Name",width:10,widthUnit:"%"},{field:"ItemService",title:"Service",width:10,widthUnit:"%"},{field:"KS-AddOns",title:"Add Ons",width:100},{field:"Rate",title:"Rate",align:"right",footerFormatter:"",width:10,widthUnit:"%"},{field:"Pcs",title:"Pcs",align:"right",width:8,widthUnit:"%"},{field:"KS-Amount",title:"Amount",align:"right",footerFormatter:"",width:15,widthUnit:"%"},{field:"location",title:"Factory",width:200},{field:"DeliveryDateTime",title:"Delivery",width:10,widthUnit:"%"},{field:"KS-Opts",title:"",width:100,visible:!1}],$e="",he="",s={data:ye,showFooter:be,columns:pe,onPostBody:$e,onClickRow:he},Te=()=>{var e=$("#table");s.onPostBody=oe,s.onClickRow=le,s.rowStyle=ge,Ae({inColumns:s.columns}),e.bootstrapTable(s)};let Ce=({inRow:e})=>{const t=e;we(t.ItemName),ve(t.pk),Ne(t.Rate)},we=e=>{let a=document.getElementById("AddOnModalItemNameId");a!==null&&(a.value=e)},ve=e=>{let a=document.getElementById("AddOnModalItemSerialId");a!==null&&(a.value=e)},Ne=e=>{let a=document.getElementById("exampleFormControlInput1");a!==null&&(a.value=e)};const De=({inRow:e})=>{let t=Ke({inItemSerial:parseInt(e.pk)});var a=$("#AddOnTable");a.bootstrapTable("load",t),Ce({inRow:e}),$("#AddOnModal").modal("show")};let Ke=({inItemSerial:e})=>{let t=i.localStorageKeys.OrderKey,a=localStorage.getItem(t),l=JSON.parse(a),o=e;return Object.keys(l.AddOnData).map(d=>L(I({},l.AddOnData[d]),{AddOnPK:d})).filter(d=>d.AddOnItemSerial===o)};const Be=async({inRowpk:e,inItemSerial:t})=>{const a=i.ApiUrls.ItemsTable.DeleteAddOnUrl;let l=localStorage.getItem("BranchName");const o=t;let c=Re(),n=a.replace("$tableName",l).replace(":Id",e).replace(":SubId",c).replace(":AddOnKey",o);return await fetch(n,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}})};let Re=()=>{let t=document.getElementById("AddOnModalItemSerialId");if(t!==null)return t.value.trim()};const Me=()=>{let e=i.localStorageKeys.OrderKey,t=localStorage.getItem(e),a=JSON.parse(t);return Ee({inItemsObject:a.ItemsInOrder})},Ee=({inItemsObject:e})=>Object.entries(e).map(([a,l])=>L(I({},l),{pk:a})),A=()=>{let e=Me();var t=$("#table");t.bootstrapTable("load",e)},He=({inResponse:e})=>{e.status===200&&(Pe("AddOnModal"),V().then(t=>{A(),$("#TableFooterItemNameId").focus()}))};function Pe(e){const t=document.querySelector("#"+e),a=bootstrap.Modal.getInstance(t);a!=null&&a.hide()}const Je=async({inItemSerial:e})=>{let t=ke(),a=await Be({inRowpk:t,inItemSerial:e});He({inResponse:a})},ke=()=>{let e=i.localStorageKeys.OrderKey,t=localStorage.getItem(e);return JSON.parse(t).pk},Ue=(e,t,a)=>{a==="KS-AddOns"&&De({inRow:e}),a==="KS-Opts"&&window.confirm("Do you really want to Delete Item?")&&Je({inItemSerial:e.AddOnService})};let xe=({inFindColumn:e})=>{e.formatter=_e},_e=(e,t,a)=>a+1,Ge=({inFindColumn:e})=>{e.footerFormatter=qe};function qe(e){var t=this.field;return e.map(function(l){return l[t]===void 0?0:+l[t]}).reduce(function(l,o){return l+o},0).toFixed(2)}let We=({inColumns:e})=>{let t=e,a=t.find(o=>o.field==="KS-Serial"),l=t.find(o=>o.field==="AddOnRate");a!==void 0&&xe({inFindColumn:a}),l!==void 0&&Ge({inFindColumn:l})};const ze=[],Qe=[{field:"KS-Serial",title:"#",width:75},{field:"AddOnService",title:"Service",width:400},{field:"AddOnRate",title:"Rate",width:200},{field:"KS-Opts",title:"",width:100}],Xe="",f={data:ze,columns:Qe,onClickRow:Xe},Ye="AddOnTable",Ze=()=>{var e=$(`#${Ye}`);f.onClickRow=Ue,We({inColumns:f.columns}),e.bootstrapTable(f)};let et=({inRow:e})=>{const t=e;tt(t.ItemName),at(t.pk),lt(t.Rate)},tt=e=>{let a=document.getElementById("AddOnModalItemNameId");a!==null&&(a.value=e)},at=e=>{let a=document.getElementById("AddOnModalItemSerialId");a!==null&&(a.value=e)},lt=e=>{let a=document.getElementById("exampleFormControlInput1");a!==null&&(a.value=e)};const ot=({inRow:e})=>{let t=rt({inItemSerial:parseInt(e.pk)});var a=$("#AddOnTable");a.bootstrapTable("load",t),et({inRow:e}),$("#AddOnModal").modal("show")};let rt=({inItemSerial:e})=>{let t=i.localStorageKeys.OrderKey,a=localStorage.getItem(t),l=JSON.parse(a),o=e;return Object.keys(l.AddOnData).map(d=>L(I({},l.AddOnData[d]),{AddOnPK:d})).filter(d=>d.AddOnItemSerial===o)};const nt=()=>{let e=i.localStorageKeys.PresentOrderAddOnsKey,t=localStorage.getItem(e);return JSON.parse(t)},dt="AddOnModalLocalStorageTable",g=()=>{let e=nt();var t=$(`#${dt}`);t.bootstrapTable("load",e===null?[]:e)},ct=({inRowIndex:e})=>{mt({inRowIndex:e}),g(),it()};let it=()=>{let t=document.getElementById("TableFooterAddOnSelectId");t!==null&&t.focus()};const mt=({inRowIndex:e})=>{let t=i.localStorageKeys.PresentOrderAddOnsKey,a=localStorage.getItem(t),l=JSON.parse(a);l.splice(e,1),localStorage.setItem(t,JSON.stringify(l))},st=(e,t,a)=>{if(console.log("row------------ : ",e,t[0].dataset.index,a),a==="KS-AddOns"&&ot({inRow:e}),a==="KS-Opts"&&window.confirm("Do you really want to Delete Item?")){const l=t[0].dataset.index;ct({inRowIndex:parseInt(l)})}},ut=()=>{let e=Lt(),t=It(),a=St(),l={};return l.AddOnService=e,l.AddOnRate=parseInt(t),l.AddOnItemSerial=parseInt(a),l};let It=()=>{let t=document.getElementById("AddOnRateId");if(t!==null)return t.value.trim()},Lt=()=>{let t=document.getElementById("TableFooterAddOnSelectId");if(t!==null)return t.value.trim()},St=()=>{let t=document.getElementById("AddOnModalItemSerialId");if(t!==null)return t.value.trim()};const ft=()=>{const e=ut();Ft({inAddOnRow:e})},Ft=({inAddOnRow:e})=>{let t=i.localStorageKeys.PresentOrderAddOnsKey,a=localStorage.getItem(t);if(a===null){localStorage.setItem(t,JSON.stringify([e]));return}let l=JSON.parse(a);l.push(e),localStorage.setItem(t,JSON.stringify(l))},y=()=>{let e=i.localStorageKeys.PresentOrderAddOnsKey,t=localStorage.getItem(e);return JSON.parse(t)},jt=({inAddOnService:e})=>y().find(l=>l.AddOnService===e)===void 0;let Ot=()=>{const e=Vt();return jt({inAddOnService:e})},Vt=()=>{let t=document.getElementById("TableFooterAddOnSelectId");if(t!==null)return t.value.trim()};const At=()=>{const e=Ot();console.log(" : ",e),e&&(ft(),g(),gt())};let gt=()=>{let t=document.getElementById("TableFooterAddOnSelectId");t!==null&&t.focus()},yt=()=>{let e=document.getElementById("AddOnModalSaveButtonId");e!==null&&e.addEventListener("click",At)};const bt=()=>{let e=i.localStorageKeys.AddOnsKey,t=localStorage.getItem(e);return JSON.parse(t)},pt=()=>{let e=document.getElementById("TableFooterAddOnSelectId"),t=bt();for(var a=0;a<t.length;a++){let l=document.createElement("option");l.value=t[a].AddOnService,l.innerHTML=t[a].AddOnService,e.appendChild(l)}},$t="AddOns",ht=()=>{const e=event.currentTarget,t=Ct({inAddOnData:e.value});wt(t)},Tt=()=>{const e=localStorage.getItem($t);return JSON.parse(e)},Ct=({inAddOnData:e})=>{const a=Tt().find(l=>l.AddOnService===e);return a===void 0?0:a.AddOnRate};let wt=e=>{let a=document.getElementById("AddOnRateId");a!==null&&(a.value=e)};const vt=e=>{e.currentTarget,e.key==="Enter"&&Nt()};let Nt=()=>{var e=new Event("click");let t=document.getElementById("AddOnModalSaveButtonId");t!==null&&t.dispatchEvent(e)},Dt=()=>{let e=document.getElementById("TableFooterAddOnSelectId");e!==null&&e.addEventListener("change",ht),e!==null&&e.addEventListener("keypress",vt)},Kt=()=>{yt(),pt(),Dt(),Bt(),$("#TableFooterItemNameId").focus()},Bt=()=>{var e=new Event("change");let t=document.getElementById("TableFooterAddOnSelectId");t!==null&&t.dispatchEvent(e)},Rt=({inFindColumn:e})=>{e.formatter=Mt},Mt=(e,t,a)=>a+1,Et=({inFindColumn:e})=>{e.footerFormatter=Ht},Ht=e=>`<input type="number" name="AddOnRate" id="AddOnRateId" class="form-control"
                                placeholder="AddOn Rate">`,Pt=({inFindColumn:e})=>{e.formatter=Jt,e.footerFormatter=kt};function Jt(e,t,a){return['<a href="#" class="btn btn-danger ">','<i class="bi bi-trash3"></i>',"</a>"].join("")}const kt=e=>`   <button type="button" class="btn btn-primary" id="AddOnModalSaveButtonId">
                                Save
                            </button>`;let Ut=({inFindColumn:e})=>{e.footerFormatter=xt};const xt=(e,t,a)=>`  <select class="form-select" aria-label="Select AddOn" id="TableFooterAddOnSelectId">
                            </select>`;let _t=({inColumns:e})=>{let t=e,a=t.find(n=>n.field==="KS-Serial"),l=t.find(n=>n.field==="KS-Opts"),o=t.find(n=>n.field==="AddOnService"),c=t.find(n=>n.field==="AddOnRate");a!==void 0&&Rt({inFindColumn:a}),l!==void 0&&Pt({inFindColumn:l}),o!==void 0&&Ut({inFindColumn:o}),c!==void 0&&Et({inFindColumn:c})};const Gt=[],qt=[{field:"KS-Serial",title:"#",width:75},{field:"AddOnService",title:"Service",width:400},{field:"AddOnRate",title:"Rate",width:200},{field:"KS-Opts",title:"Options",width:100}],Wt="",zt="",S={data:Gt,columns:qt,onPostBody:Wt,onClickRow:zt},Qt="AddOnModalLocalStorage",Xt=()=>{document.getElementById(Qt);var e=$("#table");S.onPostBody=Kt,S.onClickRow=st,_t({inColumns:S.columns}),e.bootstrapTable(S)},Yt=()=>{Te(),Ze(),Xt()};let Zt=()=>{ea(),ta()},ea=()=>{let t=document.getElementById("BranchNameId"),a=localStorage.getItem("BranchName");t!==null&&(t.innerHTML=a)};const ta=()=>{const e=new Date,t=e.toISOString().split("T")[0];e.setDate(e.getDate()+7);const a=e.toISOString().split("T")[0],l=document.getElementById("TableFooterdateInputId");l&&(l.value=a,l.setAttribute("min",t))},aa=async()=>{Zt(),Yt(),await X(),k()},la=()=>{let e=i.localStorageKeys.OrderKey,t=localStorage.getItem(e);return JSON.parse(t)},oa=()=>{let e=la();ca(e.CustomerData.CustomerMobile),da(e.CustomerData.CustomerName),na(e.pk),ra(localStorage.getItem("BranchName"))};let ra=e=>{let t="BranchNameAnchorId",l=e.replace("BranOrders",""),o=document.getElementById(t);o!==null&&(o.innerHTML=l),yuf-wnbz-jtk},na=e=>{let a=document.getElementById("OrderNumberId");a!==null&&(a.innerHTML=e)},da=e=>{let a=document.getElementById("CustomerNameId");a!==null&&(a.value=e)},ca=e=>{let a=document.getElementById("CustomerMobileId");a!==null&&(a.value=e)};const O=()=>{A(),oa()},ia=()=>{let e=i.localStorageKeys.PresentOrderAddOnsKey;y()===null&&localStorage.setItem(e,JSON.stringify([]))},ma=async()=>{await aa(),w({inSuccessFunc:O})&&(ia(),O())};ma().then();
